(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app~8a51b5ed"],{"0369":function(e,t,a){"use strict";a("60cf")},"0409":function(e,t,a){},"0eab":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:" ",attrs:{id:"menuConfig"}},[a("div",{staticClass:"select-tree-box"},[a("div",{staticClass:"tree-box tree-first"},[a("a-spin",{attrs:{spinning:e.moduleSpin,tip:"正在加载模块数据..."}},[a("c-check-tree",{ref:"tree1",attrs:{propTreeData:e.tree1stData,checkedKeys:e.checked1stKeys,checkable:!1,disabled:"",placeholder:"选择下方的模块信息获搜索...",errorTip:"没有符合的数据供选择"},on:{onTreeSelect:e.change1stCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-second "},[a("a-spin",{attrs:{spinning:e.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree2",attrs:{propTreeData:e.tree2ndData,placeholder:"勾选下方版本数据或搜索版本",checkedKeys:e.checked2ndKeys,errorTip:"勾选版本信息前需要先选择最左侧的模块信息"},on:{changeCheckedKeys:e.change2ndCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-third "},[a("a-spin",{attrs:{spinning:e.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree3",attrs:{propTreeData:e.tree3rdData,errorTip:"勾选机构信息前需要先选择最左侧的模块信息",placeholder:"勾选下方机构数据或搜索机构",checkedKeys:e.checked3rdKeys},on:{changeCheckedKeys:e.change3rdCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-fourth "},[a("a-spin",{attrs:{spinning:e.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree4",attrs:{propTreeData:e.tree4thData,checkedKeys:e.checked4thKeys,errorTip:"勾选菜单信息前需要先选择最左侧的模块信息",placeholder:"勾选下方菜单信息或搜索菜单"},on:{changeCheckedKeys:e.change4thCheckedKeys}})],1)],1)]),a("div",{staticClass:"action-box"},[a("a-button",{attrs:{type:"primary",disabled:e.validCheck()},on:{click:e.mutilateInfoSelect}},[e._v("生成列表")])],1),e.alternativeList.length?a("div",{staticClass:"mul-box"},[a("div",{staticClass:"check-head"},[e._v(" 本次勾选数据组成的权限信息 ")]),a("div",{staticClass:"check-content"},[a("permissionResult",{attrs:{permissionData:e.alternativeList,dict:e.labelInfo}})],1)]):e._e()])},s=[],r=a("2909"),n=(a("d81d"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("25f0"),a("7db0"),a("88df")),d=a("69da"),o=(a("f5ef"),function a(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0===s&&(s="key");var r={};return e.some(function(e){if(e[s]===i)return r=e,!0;if(e.children&&e.children.length>0){var t=a(e.children,i,s);if(void 0!==t)return r=t,!0}}),void 0===r&&(r=null),r}),c={props:{checked1stKeys:{type:Array,default:function(){return[]}},tree1stData:{type:Array,default:function(){return[]}}},components:{permissionResult:d["default"]},data:function(){return{userInfo:{},spin:!1,containerView:"preview",savaFlag:!1,moduleSpin:!1,loadingFlag:!1,treeData:[],tree2ndData:[],tree3rdData:[],tree4thData:[],dataTree:{},checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[],tempChecked:{checked1stKeys:[],checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[]},defaultExpandedKeys:[],selectedKeys:[],selectTableKeys:[],alternativeList:[],alternativeKeys:[],alternativeAllKeys:[],userReportMenu:[],labelInfo:{},indeterminateAlternativeList:!1,checkAllAlternativeList:!1,treeMenuList:[{menuKey:"insert",menuName:"新增",icon:"plus"},{menuKey:"edit",menuName:"修改",icon:"edit"},{menuKey:"delete",menuName:"删除",icon:"delete"}]}},mounted:function(){},methods:{onChange:function(e){this.indeterminateAlternativeList=!!e.length&&e.length<this.alternativeAllKeys.length,this.checkAllAlternativeList=e.length===this.alternativeAllKeys.length},onCheckAllChangeAlternativeList:function(){this.checkAllAlternativeList?this.alternativeKeys=[]:this.alternativeKeys=this.alternativeAllKeys,this.indeterminateAlternativeList=!1,this.checkAllAlternativeList=!this.checkAllAlternativeList},validCheck:function(){var e=this.checked2ndKeys,t=this.checked3rdKeys,a=this.checked4thKeys;return e.length<1||t.length<1||a.length<1},selectedToCheck:function(){var e=this.userReportMenu,t=this.checked2ndKeys,a=this.checked3rdKeys,i=this.checked4thKeys;this.tempChecked={checked2ndKeys:t,checked3rdKeys:a,checked4thKeys:i},e.map(function(e){t.push(e.reportSid),a.push(e.orgSid),i.push(e.menuSid)}),this.checked2ndKeys=Object(r["a"])(new Set(t)),this.checked3rdKeys=Object(r["a"])(new Set(a)),this.checked4thKeys=Object(r["a"])(new Set(i))},mutilateInfoSelect:function(){var r=this,n=this.userInfo.sid,d=this.$refs.tree1.getParentKey(this.checked1stKeys[0]),o=[],c=0,e=this.$refs.tree2.getCheckedFullInfo(),t=this.$refs.tree3.getCheckedFullInfo(),l=this.$refs.tree4.getCheckedFullInfo();e.map(function(i){var s=r.$refs.tree2.getCheckedInfo(i.key);t.map(function(a){l.map(function(e){var t=[i.title,a.title,e.title].toString().replaceAll(",","-");r.alternativeAllKeys.push(c),o.push({menuSid:e.key,projectSid:d,orgSid:a.key,reportSid:s.key,moduleSid:r.checked1stKeys[0],versionSid:i.versionSid,userSid:n,label:t,value:c,sid:c++})})})}),this.alternativeList=o,this.$emit("updateNewRecord",o)},handleCancel:function(){this.$refs.crm.close()},handleSave:function(){this.addRecord()},getFinalList:function(){var e=this.alternativeList;for(var t in e)delete e[t].label,delete e[t].value,delete e[t].index;return e},addRecord:function(){var t=this;this.savaFlag=!0,Object(n["d"])(this.userInfo.sid,this.checked1stKeys[0],alternativeList).then(function(e){t.$message.success("授权结果：".concat(e.msg))}).catch(function(e){t.$message.error("授权失败。".concat(e.message))}).finally(function(){t.savaFlag=!1})},init:function(){var e=this;this.treeData=[],this.tree2ndData=[],this.tree3rdData=[],this.tree4thData=[],this.dataTree={},this.checked2ndKeys=[],this.checked3rdKeys=[],this.checked4thKeys=[],this.defaultExpandedKeys=[],this.selectedKeys=[],this.selectTableKeys=[],this.alternativeList=[],this.alternativeKeys=[],this.alternativeAllKeys=[],this.indeterminateAlternativeList=!1,this.checkAllAlternativeList=!1,this.userReportMenu=[],this.$nextTick(function(){e.$refs.tree1.cleanSelect()})},open:function(e){this.userInfo=e,this.init()},change1stCheckedKeys:function(e){var i=this;if(this.$refs.tree1.setSelect([e]),this.$forceUpdate(),this.spin=!0,this.$emit("checked1stKeys",[e]),void 0===e||!e.length)return this.tree2ndData=[],this.tree3rdData=[],this.tree4thData=[],this.spin=!1,!1;Object(n["a"])(this.userInfo.sid,e).then(function(t){i.tree2ndData=t.data.report,i.tree3rdData=t.data.org,i.tree4thData=t.data.menu,i.dataTree=t.data;var a={};t.data.userReportMenu&&t.data.userReportMenu.length>0&&(i.userReportMenu=t.data.userReportMenu,t.data.userReportMenu.map(function(e){a.projectSid||(a.projectSid={}),a.versionSid||(a.versionSid={}),a.reportSid||(a.reportSid={}),a.moduleSid||(a.moduleSid={}),a.orgSid||(a.orgSid={}),a.menuSid||(a.menuSid={}),a.projectSid[e.projectSid]=o(i.tree1stData,e.projectSid),a.versionSid[e.versionSid]=o(i.tree2ndData,e.versionSid),a.reportSid[e.reportSid]=o(t.data.report,e.reportSid),a.moduleSid[e.moduleSid]=o(i.tree1stData,e.moduleSid),a.orgSid[e.orgSid]=o(t.data.org,e.orgSid),a.menuSid[e.menuSid]=o(t.data.menu,e.menuSid)}),i.labelInfo=a)}).finally(function(){i.spin=!1})},processLabelInfo:function(e){var t=this,a={};return e&&e.length>0&&e.map(function(e){a.projectSid||(a.projectSid={}),a.versionSid||(a.versionSid={}),a.reportSid||(a.reportSid={}),a.moduleSid||(a.moduleSid={}),a.orgSid||(a.orgSid={}),a.menuSid||(a.menuSid={}),a.projectSid[e.projectSid]=o(t.tree1stData,e.projectSid),a.versionSid[e.versionSid]=o(t.tree2ndData,e.versionSid),a.reportSid[e.reportSid]=o(t.tree2ndData,e.reportSid),a.moduleSid[e.moduleSid]=o(t.tree1stData,e.moduleSid),a.orgSid[e.orgSid]=o(t.tree3rdData,e.orgSid),a.menuSid[e.menuSid]=o(t.tree4thData,e.menuSid)}),a},change2ndCheckedKeys:function(e){this.checked2ndKeys=e},change3rdCheckedKeys:function(e){this.checked3rdKeys=e},change4thCheckedKeys:function(e){this.checked4thKeys=e},loadProjectTree:function(){var t=this;this.moduleSpin=!0,Object(n["b"])(this.userInfo.sid).then(function(e){t.tree1stData=e.data}).catch(function(e){t.$message.error(e.message)}).finally(function(){t.moduleSpin=!1})},onTreeSelect:function(e,t){this.formQuery({sid:e[0]})},handleOpenVersionManage:function(t){var e=this.tableData.content.find(function(e){return e.sid===t});this.$refs.ModalVersionManage.open(e)}}},l=c,h=(a("7da0"),a("821b"),a("f859"),a("2877")),u=Object(h["a"])(l,i,s,!1,null,"2d781ac5",null);t["default"]=u.exports},1314:function(e,t,a){"use strict";a("405c")},"1a18":function(e,t,a){"use strict";a.r(t);var i=function(){var a=this,e=a.$createElement,i=a._self._c||e;return i("div",[i("c-resizable-modal",{ref:"crm",attrs:{modalWidth:"55%",title:("insert"==a.mode?"新增":"编辑")+"版本"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("a-spin",{attrs:{spinning:a.spin}},[i("a-form-model",{ref:"addForm",attrs:{model:a.addForm,labelCol:{span:6},wrapperCol:{span:18},rules:a.addFormRule}},[i("a-row",{attrs:{gutter:15}},[i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"版本属性",prop:"versionAttributes"}},[i("a-select",{model:{value:a.addForm.versionAttributes,callback:function(e){a.$set(a.addForm,"versionAttributes",e)},expression:"addForm.versionAttributes"}},a._l(a.versionAttributesList,function(e,t){return i("a-select-option",{key:t,attrs:{value:e.key}},[a._v(a._s(e.value))])}),1)],1)],1),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"版本名称",prop:"versionName"}},[i("a-input",{model:{value:a.addForm.versionName,callback:function(e){a.$set(a.addForm,"versionName",e)},expression:"addForm.versionName"}})],1)],1),"2"===a.addForm.versionAttributes?i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"父类编号",prop:"parentSid"}},[i("a-tree-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","tree-node-filter-prop":"title","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"下拉选择上级编号","allow-clear":"","tree-data":a.parentSidSelectItems},model:{value:a.addForm.parentSid,callback:function(e){a.$set(a.addForm,"parentSid",e)},expression:"addForm.parentSid"}})],1)],1):a._e(),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"频度",prop:"versionFreq"}},[i("a-select",{model:{value:a.addForm.versionFreq,callback:function(e){a.$set(a.addForm,"versionFreq",e)},expression:"addForm.versionFreq"}},a._l(a.versionFreqList,function(e,t){return i("a-select-option",{key:t,attrs:{value:e.key}},[a._v(a._s(e.value))])}),1)],1)],1),"1"==a.addForm.versionAttributes?i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"默认版本",prop:"defaultVersion"}},[i("a-select",{model:{value:a.addForm.defaultVersion,callback:function(e){a.$set(a.addForm,"defaultVersion",e)},expression:"addForm.defaultVersion"}},a._l(a.defaultVersionList,function(e,t){return i("a-select-option",{key:t,attrs:{value:e.key}},[a._v(a._s(e.value))])}),1)],1)],1):a._e(),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"排序",prop:"sort"}},[i("a-input-number",{staticStyle:{width:"100%"},model:{value:a.addForm.sort,callback:function(e){a.$set(a.addForm,"sort",e)},expression:"addForm.sort"}})],1)],1),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"版本状态",prop:"status"}},[i("a-select",{model:{value:a.addForm.status,callback:function(e){a.$set(a.addForm,"status",e)},expression:"addForm.status"}},a._l(a.statusList,function(e,t){return i("a-select-option",{key:t,attrs:{value:e.key}},[a._v(a._s(e.value))])}),1)],1)],1),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"创建者编号",prop:"creatorSid"}},[i("a-input",{attrs:{disabled:""},model:{value:a.addForm.creatorSid,callback:function(e){a.$set(a.addForm,"creatorSid",e)},expression:"addForm.creatorSid"}})],1)],1),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"创建时间",prop:"createTime"}},[i("a-date-picker",{staticStyle:{width:"100%"},attrs:{showTime:{format:"HH:mm:ss"},disabled:""},model:{value:a.addForm.createTime,callback:function(e){a.$set(a.addForm,"createTime",e)},expression:"addForm.createTime"}})],1)],1),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"修改者编号",prop:"editorSid"}},[i("a-input",{attrs:{disabled:""},model:{value:a.addForm.editorSid,callback:function(e){a.$set(a.addForm,"editorSid",e)},expression:"addForm.editorSid"}})],1)],1),i("a-col",{attrs:{span:12}},[i("a-form-model-item",{attrs:{label:"修改时间",prop:"updateTime"}},[i("a-date-picker",{staticStyle:{width:"100%"},attrs:{showTime:{format:"HH:mm:ss"},disabled:""},model:{value:a.addForm.updateTime,callback:function(e){a.$set(a.addForm,"updateTime",e)},expression:"addForm.updateTime"}})],1)],1),i("a-col",{attrs:{span:24}},[i("a-form-model-item",{attrs:{label:"备注",prop:"note",labelCol:{span:3},wrapperCol:{span:21}}},[i("a-input",{attrs:{type:"textarea"},model:{value:a.addForm.remark,callback:function(e){a.$set(a.addForm,"remark",e)},expression:"addForm.remark"}})],1)],1)],1)],1)],1)],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("a-button",{staticClass:"margin-btn",attrs:{type:"info",icon:"close"},on:{click:a.handleCancel}},[a._v("取 消")]),i("a-button",{staticClass:"margin-btn",attrs:{type:"primary",icon:"check",loading:a.saveLoading},on:{click:a.handleSave}},[a._v("保存")])],1)])],1)},s=[],r=(a("d3b7"),a("ed08")),n=a("cdb6"),d=a("f5ef"),o={data:function(){return{mode:"insert",saveLoading:!1,spin:!1,addForm:{},parentSidSelectItems:[],addFormRule:{moduleSid:[{required:!0,message:"模块编号不允许为空",trigger:"blur"}],moduleName:[{required:!0,message:"模块名称不允许为空",trigger:"blur"}],versionAttributes:[{required:!0,message:"必须选择一个版本属性",trigger:"blur"}],versionName:[{required:!0,message:"不允许为空",trigger:"blur"}],parentSid:[{required:!0,message:"不允许为空",trigger:"blur"}],versionFreq:[{required:!0,message:"必须给定一个值",trigger:"blur"}],status:[{required:!0,message:"必须给定一个值",trigger:"blur"}]},versionAttributesList:[{key:"1",value:"版本号"},{key:"2",value:"文件夹"}],versionFreqList:[{key:"Y",value:"年"},{key:"H",value:"半年"},{key:"S",value:"季"},{key:"M",value:"月"},{key:"T",value:"旬"},{key:"W",value:"周"},{key:"D",value:"日"}],statusList:[{key:"0",value:"正常"},{key:"1",value:"停用"}],defaultVersionList:[{key:"0",value:"否"},{key:"1",value:"是"}]}},methods:{open:function(e){this.addForm={sid:"",moduleSid:"",versionAttributes:"1",versionName:"",parentSid:"",versionFreq:"Y",defaultVersion:"1",sort:"",status:"0",creatorSid:"",createTime:"",editorSid:"",updateTime:"",remark:""},this.mode=e.mode,this.addForm.moduleSid=e.moduleSid,this.addForm.moduleCode=e.moduleCode,this.addForm.moduleName=e.moduleName,"edit"===e.mode&&this.loadData(e.sid),this.loadParentSidTreeList(),this.$refs.crm.open()},loadParentSidTreeList:function(){var t=this;Object(n["e"])(null).then(function(e){t.parentSidSelectItems=Object(r["c"])(e.data)}).catch(function(e){t.$message.error("树数据加载失败。".concat(e.message))})},reset:function(){var e=this;this.$nextTick(function(){e.addForm={}})},loadData:function(e){var t=this;this.spin=!0,Object(n["d"])(e).then(function(e){t.addForm=e.data}).finally(function(){t.spin=!1})},handleSave:function(){this.saveLoading=!0,this.$refs.addForm.validate(function(e){}),"edit"===this.mode?this.updateRecord():this.addRecord()},updateRecord:function(){var t=this;Object(n["f"])(this.addForm).then(function(e){t.$message.success("数据已修改成功"),d["a"].$emit("reloadData"),t.$refs.crm.close()}).finally(function(){t.saveLoading=!1})},addRecord:function(){var t=this;Object(n["a"])(this.addForm).then(function(e){t.$message.success("数据已新增成功"),d["a"].$emit("reloadData"),t.$refs.crm.close()}).finally(function(){t.saveLoading=!1})},handleCancel:function(){var e=this;e.$refs.crm.close()}}},c=o,l=a("2877"),h=Object(l["a"])(c,i,s,!1,null,"46c2d385",null);t["default"]=h.exports},"2a5a":function(e,t,a){},"33f1":function(e,t,a){},"405c":function(e,t,a){},4370:function(e,t,a){},"4b36":function(e,t,a){"use strict";a("33f1")},"513d":function(e,t,a){"use strict";a("54c8")},5144:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("c-resizable-modal",{ref:"crm",attrs:{title:"模块的版本预览",footer:null}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("a-spin",{attrs:{tip:"正在请求数据...",spinning:e.spinning}},[a("c-check-tree",{attrs:{propTreeData:e.treeData,checkedKeys:e.checkedKeys,checkable:!1},on:{changeCheckedKeys:e.changeCheckedKeys,reloadTreeData:e.reloadTreeData}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{staticClass:"margin-btn",attrs:{type:"info",icon:"close"},on:{click:e.handleCancel}},[e._v("取 消")]),a("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:role:updateRoleModuleRel"],expression:"['system:role:updateRoleModuleRel']"}],staticClass:"margin-btn",attrs:{type:"primary",icon:"check",loading:e.saveLoading},on:{click:e.handleSave}},[e._v("更 新")])],1)])],1)},s=[],r=(a("d3b7"),a("25f0"),a("3528")),n=a("cdb6"),d=a("ed08"),o={data:function(){return{saveLoading:!1,versionInfo:{},spinning:!0,treeData:[],checkedKeys:[]}},methods:{reset:function(){this.leftSourceData=[],this.rightTargetKeys=[],this.checkedKeys=[],this.treeData=[]},open:function(e){this.versionInfo=e,this.reset(),this.loadTreeData(),this.spinning=!0,this.$refs.crm.open()},reloadTreeData:function(){this.loadTreeData()},loadTreeData:function(){var t=this;Object(n["e"])(this.versionInfo.sid).then(function(e){if(!Object(d["l"])(e))throw new Error(e.msg);t.treeData=e.data,t.checkedKeys=t.checkKeys(t.treeData)}).catch(function(e){t.$message.error(e.message)}).finally(function(){t.spinning=!1})},checkKeys:function(e){var t=[],a=[];for(var i in e){var s=e[i];"0"===s.isChecked&&(t.push(s.key),a.push(s.title)),s.children&&s.children.length>0&&t.push.apply(t,this.checkKeys(s.children))}return t},handleSave:function(){this.saveLoading=!0;var t=this,e={roleSid:this.versionInfo.sid,moduleSid:this.checkedKeys.toString(),isRelation:"0"};Object(r["k"])(e).then(function(e){if(!Object(d["l"])(e))throw new Error(e.msg);t.$message.success("角色与项目的信息已更新"),t.$refs.crm.close()}).catch(function(e){t.$message.error("错误："+e.message)}).finally(function(){t.saveLoading=!1})},changeCheckedKeys:function(e){this.checkedKeys=e},handleCancel:function(){this.$refs.crm.close()}}},c=o,l=a("2877"),h=Object(l["a"])(c,i,s,!1,null,"505e356e",null);t["default"]=h.exports},5352:function(e,t,a){},"54c8":function(e,t,a){},"571f":function(e,t,a){"use strict";a.r(t);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"report-permission-accredit-box",attrs:{id:"menuConfig"}},[a("c-resizable-modal",{ref:"crm",attrs:{modalWidth:"90%",maskClosable:!1}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("a-tabs",{attrs:{type:"card",tabPosition:"top"},on:{change:t.onTabsChange},model:{value:t.containerView,callback:function(e){t.containerView=e},expression:"containerView"}},[a("a-tab-pane",{key:"preview",attrs:{tab:"预览"}}),a("a-tab-pane",{key:"add",attrs:{tab:"新增"}})],1),t._v(" 对用户 “"+t._s(t.userInfo.userName)+"（"+t._s(t.userInfo.userCode)+"）” 的报表权限授予 //没做完TODO ")],1),a("div",{staticClass:"container-box"},[a("transition-group",{attrs:{name:"slide-fade",appear:"",mode:"out-in"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"preview"==t.containerView,expression:"containerView=='preview'"}],key:"preview"},[a("div",{staticClass:"select-tree-box"},[a("div",{staticClass:"tree-box tree-first"},[a("a-spin",{attrs:{spinning:t.moduleSpin,tip:"正在加载模块数据..."}},[a("c-check-tree",{ref:"tree1",attrs:{propTreeData:t.tree1stData,checkedKeys:t.checked1stKeys,checkable:!1,placeholder:"选择下方的模块信息获搜索...",errorTip:"没有符合的数据供选择"},on:{onTreeSelect:t.change1stCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-second "},[a("a-spin",{attrs:{spinning:t.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree2",attrs:{propTreeData:t.tree2ndData,placeholder:"勾选下方版本数据或搜索版本",checkedKeys:t.checked2ndKeys,errorTip:"勾选版本信息前需要先选择最左侧的模块信息",canSelectAll:!1,canJoint:!1},on:{onTreeSelect:t.select2ndKeys,changeCheckedKeys:t.change2ndCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-third "},[a("a-spin",{attrs:{spinning:t.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree3",attrs:{propTreeData:t.tree3rdData,errorTip:"勾选机构信息前需要先选择最左侧的模块信息",placeholder:"勾选下方机构数据或搜索机构",canSelectAll:!1,canJoint:!1,disabled:t.tree3rdDisabled,checkedKeys:t.checked3rdKeys},on:{onTreeSelect:t.select3rdKeys,changeCheckedKeys:t.change3rdCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-fourth "},[a("a-spin",{attrs:{spinning:t.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree4",attrs:{propTreeData:t.tree4thData,checkedKeys:t.checked4thKeys,canSelectAll:!1,canJoint:!1,errorTip:"勾选菜单信息前需要先选择最左侧的模块信息",disabled:t.tree4thDisabled,placeholder:"勾选下方菜单信息或搜索菜单"},on:{changeCheckedKeys:t.change4thCheckedKeys}})],1)],1)]),a("div",{staticClass:"action-box"},[a("a-button",{attrs:{type:"primary"},on:{click:t.previewUpdate}},[t._v("生成预览")])],1),a("div",{staticClass:"mul-box"},[a("div",{staticClass:"check-head"},[t._v(" 当前的权限信息 ")]),a("div",{staticClass:"check-content"},[a("permissionResult",{attrs:{tableColumns:t.tableColumns,permissionData:t.userReportMenu,dict:t.labelInfo},on:{deletePermissionInfo:t.deletePermissionInfo}})],1)])]),a("add-panel",{directives:[{name:"show",rawName:"v-show",value:"add"==t.containerView,expression:"containerView=='add'"}],key:"add",ref:"addPanel",attrs:{checked1stKeys:t.checked1stKeys,tree1stData:t.tree1stData},on:{checked1stKeys:t.getChecked1stKeys,updateNewRecord:t.updateNewRecord}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{on:{click:t.handleCancel}},[t._v("取 消")]),a("a-button",{attrs:{type:"primary",loading:t.saveFlag},on:{click:t.handleSave}},[t._v("保 存")])],1)])],1)},s=[],r=a("2909"),n=(a("d81d"),a("c740"),a("a434"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("99af"),a("caad"),a("2532"),a("7db0"),a("69da")),d=a("88df"),o=a("0eab"),c=(a("f5ef"),function a(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0===s&&(s="key");var r={};return e.some(function(e){if(e[s]===i)return r=e,!0;if(e.children&&e.children.length>0){var t=a(e.children,i,s);if(void 0!==t)return r=t,!0}}),void 0===r&&(r=null),r}),l={data:function(){return{userInfo:{},spin:!1,containerView:"preview",saveFlag:!1,moduleSpin:!1,loadingFlag:!1,tree1stData:[],tree2ndData:[],tree3rdData:[],tree4thData:[],dataTree:{},checked1stKeys:[],checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[],select2ndKey:"",select3rdKey:"",tree4thDisabled:!0,tree3rdDisabled:!0,tempChecked:{checked1stKeys:[],checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[]},defaultExpandedKeys:[],tableColumns:[{key:"index",dataIndex:"index",title:"序号"},{key:"moduleSid",dataIndex:"moduleSid",title:"模块",hasSlot:!0},{key:"reportSid",dataIndex:"reportSid",title:"报表",hasSlot:!0},{key:"versionSid",dataIndex:"versionSid",title:"版本",hasSlot:!0},{key:"orgSid",dataIndex:"orgSid",title:"机构",hasSlot:!0},{key:"menuSid",dataIndex:"menuSid",title:"菜单",hasSlot:!0}],selectedKeys:[],selectTableKeys:[],alternativeList:[],alternativeKeys:[],alternativeAllKeys:[],userReportMenu:[],labelInfo:{},readyDeleteRecords:[],indeterminateAlternativeList:!1,checkAllAlternativeList:!1}},mounted:function(){},methods:{deletePermissionInfo:function(t){this.$createElement;var i=this;this.$confirm({title:"权限信息预删除提示",content:function(e){return e("div",["您选择了",t.length,"条信息正在进行删除操作。该操作为",e("span",{class:"textRed"},["预删除"]),"，当您点击权限配置框的保存按钮时，删除的信息才会生效。",e("p",["是否确认预删除选中权限？"])])},onOk:function(){var a=i.userReportMenu;t.map(function(t){var e=a.findIndex(function(e){return e.sid===t});-1!==e&&i.userReportMenu.splice(e,1)})},onCancel:function(){}})},updateNewRecord:function(e){this.userReportMenu=Object(r["a"])(new Set(this.userReportMenu.concat(e)))},getChecked1stKeys:function(e){this.checked1stKeys=e},onTabsChange:function(e){},onChange:function(e){this.indeterminateAlternativeList=!!e.length&&e.length<this.alternativeAllKeys.length,this.checkAllAlternativeList=e.length===this.alternativeAllKeys.length},onCheckAllChangeAlternativeList:function(){this.checkAllAlternativeList?this.alternativeKeys=[]:this.alternativeKeys=this.alternativeAllKeys,this.indeterminateAlternativeList=!1,this.checkAllAlternativeList=!this.checkAllAlternativeList},validCheck:function(){var e=this.checked2ndKeys,t=this.checked3rdKeys,a=this.checked4thKeys,i=0==e.length&&0==t.length&&0==a.length||e.length>0&&t.length>0&&a.length>0;return!i},selectedToCheck:function(){var i=this,e=this.userReportMenu,s=this.checked2ndKeys,t=this.checked3rdKeys,a=this.checked4thKeys;this.tempChecked={checked2ndKeys:s,checked3rdKeys:t,checked4thKeys:a},e.map(function(e){var t=e.reportSid,a=i.$refs.tree2.getCheckedInfo(t);void 0!==a&&e.versionSid===a.versionSid&&s.push(e.reportSid)}),this.checked2ndKeys=Object(r["a"])(new Set(s)),this.$refs.tree2.onChangeExpand({target:{checked:!0}})},previewUpdate:function(){if(this.validCheck())return this.$message.warning("权限配置不完整，无法生成预览。"),!1;var a=this.userReportMenu;this.readyDeleteRecords.map(function(e){var t=a.indexOf(e);-1!==t&&a.splice(t,1)}),this.userReportMenu=a},handleCancel:function(){this.$refs.crm.close()},handleSave:function(){this.addRecord()},addRecord:function(){var t=this,e=this.userReportMenu,a=this.checked1stKeys;for(var i in e)delete e[i].label,delete e[i].value,delete e[i].index;this.saveFlag=!0;var s=this.$refs.addPanel.getFinalList(),r=e.concat(s);Object(d["d"])(this.userInfo.sid,a[0],r).then(function(e){t.$message.success("授权结果：".concat(e.msg,"。1.5秒后跳转到预览面板显示结果")),setTimeout(function(){t.$refs.addPanel.init(),t.init(),t.containerView="preview"},1500)}).catch(function(e){t.$message.error("授权失败。".concat(e.message))}).finally(function(){t.saveFlag=!1})},init:function(){var e=this;this.tree2ndData=[],this.tree3rdData=[],this.tree4thData=[],this.dataTree={},this.checked1stKeys=[],this.checked2ndKeys=[],this.checked3rdKeys=[],this.checked4thKeys=[],this.defaultExpandedKeys=[],this.selectedKeys=[],this.selectTableKeys=[],this.alternativeList=[],this.alternativeKeys=[],this.alternativeAllKeys=[],this.indeterminateAlternativeList=!1,this.checkAllAlternativeList=!1,this.userReportMenu=[],this.$nextTick(function(){e.$refs.tree1.cleanSelect()})},open:function(e){var t=this;this.containerView="",this.containerView="preview",this.userInfo=e,this.$refs.crm.open(),this.init(),this.loadProjectTree(),this.$nextTick(function(){t.$refs.addPanel.open(t.userInfo)})},change2ndCheckedKeys:function(e,t,a){var i=this;if("undefined"==typeof t||this.validCheckedNodeIsPresent(this.tempChecked.checked2ndKeys,t))if(this.checked2ndKeys=e,a){var s=[];this.readyDeleteRecords.map(function(e){t===e.reportSid&&s.push(e)}),s.map(function(e){var t=i.readyDeleteRecords.indexOf(e);-1!==t&&i.readyDeleteRecords.splice(t,1)})}else this.userReportMenu.map(function(e){e.reportSid===t&&i.readyDeleteRecords.push(e)}),t==this.select2ndKey&&(this.checked3rdKeys=[],this.checked4thKeys=[])},generateData:function(){},change1stCheckedKeys:function(e){var i=this;if(this.$refs.addPanel.change1stCheckedKeys(e),this.spin=!0,this.checked1stKeys=[e],void 0===e||!e.length)return this.tree2ndData=[],this.tree3rdData=[],this.tree4thData=[],this.spin=!1,!1;Object(d["a"])(this.userInfo.sid,e).then(function(t){i.tree2ndData=t.data.report,i.tree3rdData=t.data.org,i.tree4thData=t.data.menu,i.dataTree=t.data;var a={};t.data.userReportMenu&&t.data.userReportMenu.length>0&&(i.userReportMenu=t.data.userReportMenu,t.data.userReportMenu.map(function(e){a.projectSid||(a.projectSid={}),a.versionSid||(a.versionSid={}),a.reportSid||(a.reportSid={}),a.moduleSid||(a.moduleSid={}),a.orgSid||(a.orgSid={}),a.menuSid||(a.menuSid={}),a.projectSid[e.projectSid]=c(i.tree1stData,e.projectSid),a.versionSid[e.versionSid]=c(t.data.report,e.versionSid),a.reportSid[e.reportSid]=c(t.data.report,e.reportSid),a.moduleSid[e.moduleSid]=c(i.tree1stData,e.moduleSid),a.orgSid[e.orgSid]=c(t.data.org,e.orgSid),a.menuSid[e.menuSid]=c(t.data.menu,e.menuSid)}),i.labelInfo=a)}).then(function(){i.selectedToCheck(),i.tree3rdDisabled=!0,i.tree4thDisabled=!0}).finally(function(){i.spin=!1})},validCheckedNodeIsPresent:function(e,t){if(void 0===t||void 0===e)return!1;var a=e.includes(t);return a||this.$message.warning("无法操作先前未拥有的、或者变更删除的权限节点"),a},select2ndKeys:function(t){var a=this;this.select2ndKey=t;var i=[],s=[];this.validCheckedNodeIsPresent(this.tempChecked.checked2ndKeys,t)?this.userReportMenu.map(function(e){e.reportSid===t&&(i.push(e.orgSid),s.push(e.menuSid),a.tree3rdDisabled=!1)}):(this.tree4thDisabled=!0,this.tree3rdDisabled=!0),i=Object(r["a"])(new Set(i)),s=Object(r["a"])(new Set(s)),this.tempChecked.checked3rdKeys=i,this.tempChecked.checked4thKeys=s,this.checked3rdKeys=i,this.checked4thKeys=s},select3rdKeys:function(t){var a=this;this.select3rdKey=t;var i=[];this.validCheckedNodeIsPresent(this.tempChecked.checked3rdKeys,t)?this.userReportMenu.map(function(e){e.orgSid===t&&(i.push(e.menuSid),a.tree4thDisabled=!1)}):this.tree4thDisabled=!0,i=Object(r["a"])(new Set(i)),this.tempChecked.checked4thKeys=i,this.checked4thKeys=i},change3rdCheckedKeys:function(e,t,a){var i=this,s=this.select2ndKey,r=this.select3rdKey;if(this.validCheckedNodeIsPresent(this.tempChecked.checked3rdKeys,t))if(this.checked3rdKeys=e,this.$forceUpdate(),a){var n=[];this.readyDeleteRecords.map(function(e){t===e.orgSid&&s===e.reportSid&&n.push(e)}),n.map(function(e){var t=i.readyDeleteRecords.indexOf(e);-1!==t&&i.readyDeleteRecords.splice(t,1)})}else this.userReportMenu.map(function(e){e.orgSid===t&&s===e.reportSid&&i.readyDeleteRecords.push(e)}),r===t&&(this.checked4thKeys=[])},change4thCheckedKeys:function(e,t,a){var i=this,s=this.select2ndKey,r=this.select3rdKey;if(this.validCheckedNodeIsPresent(this.tempChecked.checked4thKeys,t))if(this.checked4thKeys=e,a){var n=[];this.readyDeleteRecords.map(function(e){t===e.menuSid&&s===e.reportSid&&n.push(e)}),n.map(function(e){var t=i.readyDeleteRecords.indexOf(e);-1!==t&&i.readyDeleteRecords.splice(t,1)})}else this.userReportMenu.map(function(e){e.menuSid===t&&r===e.orgSid&&i.readyDeleteRecords.push(e)})},loadProjectTree:function(){var t=this;this.moduleSpin=!0,Object(d["b"])(this.userInfo.sid).then(function(e){t.tree1stData=e.data}).catch(function(e){t.$message.error(e.message)}).finally(function(){t.moduleSpin=!1})},rightClickMenuItem:function(e,t){switch(t){case"insert":this.handleAdd(e);break;case"edit":this.handleEdit(e);break;case"delete":this.handleDelete([e]);break}},onTreeSelect:function(e,t){this.formQuery({sid:e[0]})},handleOpenVersionManage:function(t){var e=this.tableData.content.find(function(e){return e.sid===t});this.$refs.ModalVersionManage.open(e)}},components:{addPanel:o["default"],permissionResult:n["default"]}},h=l,u=(a("4b36"),a("513d"),a("e8ace"),a("2877")),p=Object(u["a"])(h,i,s,!1,null,"53645ac4",null);t["default"]=p.exports},5859:function(e,t,a){},"60cf":function(e,t,a){},"61f4":function(e,t,a){"use strict";a("b808")},"69da":function(e,t,a){"use strict";a.r(t);var i=function(){var i=this,e=i.$createElement,s=i._self._c||e;return i.permissionData.length?s("div",[s("c-query-form-table",{attrs:{tableColumns:i.tableColumns,tableData:i.tableData,searchParams:i.searchParams,needTableCheckList:!0,selectTableKeys:i.selectTableKeys},on:{selectTableKeysChangeFromQFT:i.selectTableKeysChangeFromQFT,reloadData:i.reloadData,formQuery:i.formQuery},scopedSlots:i._u([i._l(["moduleSid","reportSid","versionSid","menuSid","orgSid"],function(t,a){return{key:t,fn:function(e){return[s("span",{key:a},[i._v(" "+i._s(i.dict[t][e.data[t]].title||"(没有译文)")+" ")])]}}}),{key:"tableActionBox",fn:function(t){return[s("a-button",{attrs:{type:"link",size:"small"},on:{click:function(e){return i.handleDelete([t.data.sid])}}},[i._v("删除")])]}}],null,!0)},[s("template",{slot:"functionBtnBox"},[s("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return i.handleDelete(i.selectTableKeys)}}},[i._v("删除")])],1)],2)],1):s("a-empty")},s=[],l=a("5530"),r=(a("d81d"),a("fb6a"),a("4de4"),{data:function(){return{tableData:{pageNum:1,pageSize:15,totalSize:0,totalPages:0,content:[]},searchParams:[{name:"moduleSid",label:"模块",type:"select",selectList:this.convertSelectList(this.dict.moduleSid)},{name:"reportSid",label:"报表",type:"select",selectList:[]},{name:"versionSid",label:"版本",type:"select",selectList:[]},{name:"menuSid",label:"菜单",type:"select",selectList:[]},{name:"orgSid",label:"机构",type:"select",selectList:[]}],selectTableKeys:[],tableColumns:[{key:"sid",dataIndex:"sid",title:"编号"},{key:"moduleSid",dataIndex:"moduleSid",title:"模块",hasSlot:!0},{key:"reportSid",dataIndex:"reportSid",title:"报表",hasSlot:!0},{key:"versionSid",dataIndex:"versionSid",title:"版本",hasSlot:!0},{key:"orgSid",dataIndex:"orgSid",title:"机构",hasSlot:!0},{key:"menuSid",dataIndex:"menuSid",title:"菜单",hasSlot:!0}]}},props:["permissionData","dict"],watch:{permissionData:{handler:function(e){e&&(this.updateTableData(e),this.updateSelectList(e))},deep:!0,immediate:!0}},methods:{convertSelectList:function(e){var t=[];for(var a in e)t.push({key:a,value:e[a].title});return t},updateSelectList:function(){this.searchParams=[{name:"moduleSid",label:"模块",type:"select",selectList:this.convertSelectList(this.dict.moduleSid)},{name:"reportSid",label:"报表",type:"select",selectList:this.convertSelectList(this.dict.reportSid)},{name:"versionSid",label:"版本",type:"select",selectList:this.convertSelectList(this.dict.versionSid)},{name:"menuSid",label:"菜单",type:"select",selectList:this.convertSelectList(this.dict.menuSid)},{name:"orgSid",label:"机构",type:"select",selectList:this.convertSelectList(this.dict.orgSid)}]},updateTableData:function(e){var t=this.tableData,a=t.pageNum,i=t.pageSize,s=--a*i,r=a*i>e.length?e.length:a*i+i,n=e.slice(s,r).map(function(e,t){return Object(l["a"])(Object(l["a"])({},e),{},{index:t})});this.tableData=Object(l["a"])(Object(l["a"])({},this.tableData),{},{totalSize:e.length,totalPages:Math.ceil(e.length/i),content:n})},handleDelete:function(e){this.$emit("deletePermissionInfo",e)},formQuery:function(i){var e=this.permissionData,t=e.filter(function(e){var t=!0;for(var a in i)if(i[a].length&&e[a]!==i[a]){t=!1;break}if(t)return e});this.tableData.pageNum=1,this.updateTableData(t)},selectTableKeysChangeFromQFT:function(e){this.selectTableKeys=e},reloadData:function(e){if("{}"!==JSON.stringify(e)){var t=e.pageNum,a=e.pageSize;this.tableData.pageNum=t,this.tableData.pageSize=a}var i=this.tableData,s=i.pageNum,r=i.pageSize,n=this.permissionData,d=--s*r,o=s*r+r>n.length?n.length:s*r+r,c=n.slice(d,o).map(function(e,t){return Object(l["a"])(Object(l["a"])({},e),{},{index:t})});this.tableData=Object(l["a"])(Object(l["a"])({},this.tableData),{},{totalSize:n.length,totalPages:Math.ceil(n.length/r),content:c})}}}),n=r,d=a("2877"),o=Object(d["a"])(n,i,s,!1,null,null,null);t["default"]=o.exports},"6f21":function(e,t,a){"use strict";a.r(t);var i=function(){var i=this,e=i.$createElement,s=i._self._c||e;return i.permissionData.length?s("div",[s("c-query-form-table",{attrs:{tableColumns:i.tableColumns,tableData:i.tableData,searchParams:i.searchParams,needTableCheckList:!0,selectTableKeys:i.selectTableKeys},on:{selectTableKeysChangeFromQFT:i.selectTableKeysChangeFromQFT,reloadData:i.reloadData,formQuery:i.formQuery},scopedSlots:i._u([i._l(["moduleSid","reportSid","versionSid","menuSid","orgSid"],function(t,a){return{key:t,fn:function(e){return[s("span",{key:a},[i._v(" "+i._s(i.dict[t][e.data[t]]||"("+t+"没有译文)")+" ")])]}}}),{key:"tableActionBox",fn:function(t){return[s("a-popconfirm",{attrs:{title:"该操作为预删除，当您点击下方的提交/创建按钮后，删除的信息才会生效。是否确认预删除当前权限？",placement:"right"},on:{confirm:function(e){return i.handleDelete([t.data.sid])}}},[s("a-button",{attrs:{type:"link",size:"small"}},[i._v("删除")])],1)]}}],null,!0)},[s("template",{slot:"functionBtnBox"},[s("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return i.handleDelete(i.selectTableKeys)}}},[i._v("删除")])],1)],2)],1):s("a-empty")},s=[],l=a("5530"),r=(a("d81d"),a("fb6a"),a("4de4"),{data:function(){return{tableData:{pageNum:1,pageSize:15,totalSize:0,totalPages:0,content:[]},searchParams:[{name:"moduleSid",label:"模块",type:"select",selectList:this.convertSelectList(this.dict.moduleSid)},{name:"reportSid",label:"报表",type:"select",selectList:[]},{name:"versionSid",label:"版本",type:"select",selectList:[]},{name:"menuSid",label:"菜单",type:"select",selectList:[]},{name:"orgSid",label:"机构",type:"select",selectList:[]}],selectTableKeys:[],tableColumns:[{key:"sid",dataIndex:"sid",title:"编号"},{key:"moduleSid",dataIndex:"moduleSid",title:"模块",hasSlot:!0},{key:"reportSid",dataIndex:"reportSid",title:"报表",hasSlot:!0},{key:"versionSid",dataIndex:"versionSid",title:"版本",hasSlot:!0},{key:"orgSid",dataIndex:"orgSid",title:"机构",hasSlot:!0},{key:"menuSid",dataIndex:"menuSid",title:"菜单",hasSlot:!0}]}},props:["permissionData","dict"],watch:{permissionData:{handler:function(e){e&&(this.updateTableData(e),this.updateSelectList(e))},deep:!0,immediate:!0}},methods:{convertSelectList:function(e){var t=[];for(var a in e)t.push({key:a,value:e[a].title});return t},updateSelectList:function(){this.searchParams=[{name:"moduleSid",label:"模块",type:"select",selectList:this.convertSelectList(this.dict.moduleSid)},{name:"reportSid",label:"报表",type:"select",selectList:this.convertSelectList(this.dict.reportSid)},{name:"versionSid",label:"版本",type:"select",selectList:this.convertSelectList(this.dict.versionSid)},{name:"menuSid",label:"菜单",type:"select",selectList:this.convertSelectList(this.dict.menuSid)},{name:"orgSid",label:"机构",type:"select",selectList:this.convertSelectList(this.dict.orgSid)}]},updateTableData:function(e){var t=this.tableData,a=t.pageNum,i=t.pageSize,s=--a*i,r=a*i>e.length?e.length:a*i+i,n=e.slice(s,r).map(function(e,t){return Object(l["a"])(Object(l["a"])({},e),{},{index:t})});this.tableData=Object(l["a"])(Object(l["a"])({},this.tableData),{},{totalSize:e.length,totalPages:Math.ceil(e.length/i),content:n})},handleDelete:function(e){this.$emit("deletePermissionInfo",e)},formQuery:function(i){var e=this.permissionData,t=e.filter(function(e){var t=!0;for(var a in i)if(i[a].length&&e[a]!==i[a]){t=!1;break}if(t)return e});this.tableData.pageNum=1,this.updateTableData(t)},selectTableKeysChangeFromQFT:function(e){this.selectTableKeys=e},reloadData:function(e){if("{}"!==JSON.stringify(e)){var t=e.pageNum,a=e.pageSize;this.tableData.pageNum=t,this.tableData.pageSize=a}var i=this.tableData,s=i.pageNum,r=i.pageSize,n=this.permissionData,d=--s*r,o=s*r+r>n.length?n.length:s*r+r,c=n.slice(d,o).map(function(e,t){return Object(l["a"])(Object(l["a"])({},e),{},{index:t})});this.tableData=Object(l["a"])(Object(l["a"])({},this.tableData),{},{totalSize:n.length,totalPages:Math.ceil(n.length/r),content:c})}}}),n=r,d=a("2877"),o=Object(d["a"])(n,i,s,!1,null,null,null);t["default"]=o.exports},"7da0":function(e,t,a){"use strict";a("ce55")},"821b":function(e,t,a){"use strict";a("a36c")},"88a3":function(e,t,a){"use strict";a.r(t);var i=function(){var a=this,e=a.$createElement,i=a._self._c||e;return i("div",{attrs:{id:"userAddBox"}},[i("c-resizable-modal",{ref:"crm",attrs:{title:"模块的版本管理",footer:null}},[i("template",{slot:"content"},[i("div",[i("h3",[i("span",[a._v("模块编号："+a._s(a.moduleItem.moduleCode))]),i("a-divider",{attrs:{type:"vertical"}}),i("span",[a._v("模块名称："+a._s(a.moduleItem.moduleName))])],1)]),i("c-query-form-table",{directives:[{name:"show",rawName:"v-show",value:!a.isShowTree,expression:"!isShowTree"}],attrs:{tableData:a.tableData,tableColumns:a.tableColumns,searchParams:a.searchParams,needTableCheckList:!0,selectTableKeys:a.selectTableKeys,loadingFlag:a.loadingFlag},on:{selectTableKeysChangeFromQFT:a.selectTableKeysChangeFromQFT,reloadData:a.reloadData,formQuery:a.formQuery,dbClick:a.dbClick},scopedSlots:a._u([{key:"tableActionBox",fn:function(t){return[i("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:i18n:edit"],expression:"['system:i18n:edit']"}],attrs:{type:"link"},on:{click:function(e){return a.handleEdit(t.data.sid)}}},[a._v("编辑")]),i("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:i18n:delete"],expression:"['system:i18n:delete']"}],attrs:{type:"link"},on:{click:function(e){return a.handleDelete([t.data.sid])}}},[a._v("删除")])]}}])},[i("template",{slot:"tableCustomPageButton"},[i("a-tooltip",[i("template",{slot:"title"},[a._v("以树结构查看版本信息")]),i("a-button",{attrs:{icon:"align-left"},on:{click:a.handleClickDataShowWay}})],2)],1),i("div",{attrs:{slot:"functionBtnBox"},slot:"functionBtnBox"},[i("div",[i("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:i18n:add"],expression:"['system:i18n:add']"}],staticClass:"margin-btn",attrs:{type:"primary",icon:"plus"},on:{click:a.handleAddI18N}},[a._v("新增")]),i("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:i18n:edit"],expression:"['system:i18n:edit']"}],staticClass:"margin-btn",attrs:{type:"primary",icon:"edit",disabled:1!==a.selectTableKeys.length},on:{click:function(e){return a.handleEdit(a.selectTableKeys[0])}}},[a._v("修改")]),i("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:i18n:delete"],expression:"['system:i18n:delete']"}],staticClass:"margin-btn",attrs:{type:"primary",icon:"delete",disabled:a.selectTableKeys.length<1},on:{click:function(e){return a.handleDelete(a.selectTableKeys)}}},[a._v("删除")])],1)])],2)],1)],2),i("modal-version-detail",{ref:"ModalVersionDetail"}),i("ModalModuleVersionPreview",{ref:"ModalModuleVersionPreview"})],1)},s=[],r=(a("d3b7"),a("25f0"),a("cdb6")),n=a("1a18"),d=a("5144"),o=a("f5ef"),c={data:function(){return{moduleItem:{},loadingFlag:!1,selectTableKeys:[],isShowTree:!1,tableColumns:[{key:"sid",dataIndex:"sid",title:"编号"},{key:"moduleSid",dataIndex:"moduleSid",title:"模块编号"},{key:"moduleName",dataIndex:"moduleName",title:"模块名称"},{key:"versionAttributes",dataIndex:"versionAttributes",title:"版本属性"},{key:"defaultVersion",dataIndex:"defaultVersion",title:"版本号"},{key:"versionName",dataIndex:"versionName",title:"版本名称"},{key:"parentSid",dataIndex:"parentSid",title:"父类编号"},{key:"parentName",dataIndex:"parentName",title:"父类名称"},{key:"versionFreq",dataIndex:"versionFreq",title:"频度"},{key:"sort",dataIndex:"sort",title:"排序"},{key:"status",dataIndex:"status",title:"版本状态"},{key:"creatorSid",dataIndex:"creatorSid",title:"创建者编号"},{key:"createTime",dataIndex:"createTime",title:"创建时间"},{key:"editorSid",dataIndex:"editorSid",title:"修改者编号"},{key:"updateTime",dataIndex:"updateTime",title:"修改时间"},{key:"remark",dataIndex:"remark",title:"备注"}],tableData:{pageSize:10,pageNum:1,content:[]},searchParams:[{name:"moduleSid",label:"模块编号",type:"input"},{name:"versionAttributes",label:"版本属性",type:"select",selectList:[{key:"1",value:"版本号"},{key:"2",value:"文件夹"}]},{name:"versionName",label:"版本名称",type:"input"},{name:"parentSid",label:"父类编号",type:"input"},{name:"versionFreq",label:"频度",type:"select",selectList:[{key:"Y",value:"年"},{key:"H",value:"半年"},{key:"S",value:"季"},{key:"M",value:"月"},{key:"T",value:"旬"},{key:"W",value:"周"},{key:"D",value:"日"}]},{name:"sort",label:"排序",type:"input"},{name:"status",label:"版本状态",type:"select",selectList:[{key:"0",value:"正常"},{key:"1",value:"停用"}]},{name:"creatorSid",label:"创建者编号",type:"input"},{name:"createTime",label:"创建时间",type:"input"},{name:"editorSid",label:"修改者编号",type:"datetime"},{name:"updateTime",label:"修改时间",type:"datetime"},{name:"remark",label:"备注",type:"input"}]}},components:{ModalVersionDetail:n["default"],ModalModuleVersionPreview:d["default"]},mounted:function(){var e=this;o["a"].$on("reloadData",function(){e.reloadData({},{})})},methods:{handleClickDataShowWay:function(){var e={sid:this.moduleItem.sid};this.$refs.ModalModuleVersionPreview.open(e)},selectTableKeysChangeFromQFT:function(e){this.selectTableKeys=e},handleAddI18N:function(){this.$refs.ModalVersionDetail.open({mode:"insert",moduleSid:this.moduleItem.sid})},open:function(e){this.moduleItem=e,this.$refs.crm.open(),this.loadData({},{moduleSid:e.sid})},loadData:function(e,t){var a=this;"{}"===JSON.stringify(e)&&(e.pageNum=this.tableData.pageNum,e.pageSize=this.tableData.pageSize),t.moduleSid||(t.moduleSid=this.moduleItem.sid),this.loadingFlag=!0,Object(r["c"])(e.pageNum,e.pageSize,t).then(function(e){a.$nextTick(function(){a.tableData.content=e.rows,a.tableData.totalSize=e.total,a.tableData.totalPages=Math.ceil(a.tableData.totalSize/a.tableData.pageSize)})}).finally(function(){a.loadingFlag=!1})},reloadData:function(e){if("{}"!==JSON.stringify(e)){var t=e.pageNum,a=e.pageSize;this.tableData.pageNum=t,this.tableData.pageSize=a}this.loadData({pageNum:this.tableData.pageNum,pageSize:this.tableData.pageSize},{})},formQuery:function(e){this.loadData({},e)},dbClick:function(e){this.handleEdit(e.sid)},handleEdit:function(e){this.$refs.ModalVersionDetail.open({mode:"edit",sid:e})},handleDelete:function(t){this.$createElement;var a=this;this.$confirm({title:"删除数据确认",content:function(e){return e("p",["即将",e("span",{class:"textRed"},["物理删除",t.length,"项数据"]),"，确认操作？"])},okType:"danger",closable:!0,onOk:function(){var e={countNum:t.length,ids:t.toString()};Object(r["b"])(e).then(function(e){a.selectTableKeys=[],a.$message.success("数据已删除成功"),a.loadData({},{})})}})}}},l=c,h=a("2877"),u=Object(h["a"])(l,i,s,!1,null,"7b409940",null);t["default"]=u.exports},"91c3":function(e,t,a){},"9cc7":function(e,t,a){"use strict";a("0409")},a36c:function(e,t,a){},ae67:function(e,t,a){"use strict";a.r(t);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("c-resizable-modal",{ref:"crm",attrs:{modalWidth:"75%",title:("insert"==t.mode?"新增":"编辑")+"模块定义"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("a-spin",{attrs:{spinning:t.spin}},[a("a-form-model",{ref:"addForm",attrs:{model:t.addForm,labelCol:{span:6},wrapperCol:{span:18},rules:t.addFormRule}},[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"模块编号",prop:"moduleCode"}},[a("a-input",{model:{value:t.addForm.moduleCode,callback:function(e){t.$set(t.addForm,"moduleCode",e)},expression:"addForm.moduleCode"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"模块名称",prop:"moduleName"}},[a("a-input",{model:{value:t.addForm.moduleName,callback:function(e){t.$set(t.addForm,"moduleName",e)},expression:"addForm.moduleName"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"项目SID",prop:"projectSid"}},[a("a-select",{attrs:{allowClear:""},model:{value:t.addForm.projectSid,callback:function(e){t.$set(t.addForm,"projectSid",e)},expression:"addForm.projectSid"}},t._l(t.projectSelectItems,function(e){return a("a-select-option",{key:e.sid,attrs:{value:e.sid}},[t._v(t._s(e.projectName))])}),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"菜单SID",prop:"menuSid"}},[a("a-tree-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","tree-node-filter-prop":"title","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"下拉选择上级编号","allow-clear":"","tree-data":t.menuSelectItems},model:{value:t.addForm.menuSid,callback:function(e){t.$set(t.addForm,"menuSid",e)},expression:"addForm.menuSid"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"模块状态",prop:"status"}},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":0},model:{value:t.addForm.status,callback:function(e){t.$set(t.addForm,"status",e)},expression:"addForm.status"}},[a("a-radio",{attrs:{value:"0"}},[t._v(" 正常 ")]),a("a-radio",{attrs:{value:"1"}},[t._v(" 停用 ")])],1)],1)],1),t.isComponentShow("all",[1,2,3,4,5,6])?a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"创建者编号",prop:"creatorSid"}},[a("a-input",{attrs:{disabled:""},model:{value:t.addForm.creatorSid,callback:function(e){t.$set(t.addForm,"creatorSid",e)},expression:"addForm.creatorSid"}})],1)],1):t._e(),t.isComponentShow("all",[1,2,3,4,5,6])?a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"创建时间",prop:"createTime"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{showTime:{format:"HH:mm:ss"},disabled:""},model:{value:t.addForm.createTime,callback:function(e){t.$set(t.addForm,"createTime",e)},expression:"addForm.createTime"}})],1)],1):t._e(),t.isComponentShow("all",[1,2,3,4,5,6])?a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"修改者编号",prop:"editorSid"}},[a("a-input",{attrs:{disabled:""},model:{value:t.addForm.editorSid,callback:function(e){t.$set(t.addForm,"editorSid",e)},expression:"addForm.editorSid"}})],1)],1):t._e(),t.isComponentShow("all",[1,2,3,4,5,6])?a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"修改时间",prop:"updateTime"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{showTime:{format:"HH:mm:ss"},disabled:""},model:{value:t.addForm.updateTime,callback:function(e){t.$set(t.addForm,"updateTime",e)},expression:"addForm.updateTime"}})],1)],1):t._e(),a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"备注",prop:"note",labelCol:{span:3},wrapperCol:{span:21}}},[a("a-input",{attrs:{type:"textarea"},model:{value:t.addForm.remark,callback:function(e){t.$set(t.addForm,"remark",e)},expression:"addForm.remark"}})],1)],1)],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{staticClass:"margin-btn",attrs:{type:"info",icon:"close"},on:{click:t.handleCancel}},[t._v("取 消")]),a("a-button",{staticClass:"margin-btn",attrs:{type:"primary",icon:"check",loading:t.saveLoading},on:{click:t.handleSave}},[t._v("保存")])],1)])],1)},s=[],r=(a("d3b7"),a("25f0"),a("7bec")),n=a("ed08"),d=(a("af00"),a("a6dc"),a("d2b6"),a("5028")),o=a("f5ef"),c=r["a"].SHOW_PARENT,l={data:function(){return{mode:"read",spin:!1,treeData:[],SHOW_PARENT:c,isModalVisible:!1,saveLoading:!1,addForm:{sid:"",menuCode:"",menuName:"",menuTitle:"",parentSid:"",menuType:"1",link:"0",routingAddress:"",routingParam:"",componentPath:"",permissions:"",cache:"0",sort:"",visible:"0",status:"",icon:"",creatorSid:"",createTime:"",editorSid:"",updateTime:"",remark:""},addFormRule:{menuCode:[{required:!0,message:"菜单编号不允许为空",trigger:"blur"}],menuName:[{required:!0,message:"菜单名称不允许为空",trigger:"blur"}],link:[{required:!0,message:"必须选择一个菜单外链值",trigger:"blur"}],menuType:[{required:!0,message:"必须选择一个菜单类型",trigger:"blur"}],visible:[{required:!0,message:"必须给定一个可见值",trigger:"blur"}],cache:[{required:!0,message:"必须给定一个缓存值",trigger:"blur"}],status:[{required:!0,message:"必须给定一个状态值",trigger:"blur"}]},projectSelectItems:[],menuSelectItems:[]}},mounted:function(){},methods:{projectSearchFilterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},isComponentShow:function(e,t){if("all"===e){for(var a in t){var i=this.addForm.menuType===t[a].toString();if(i)return!0}return!1}if("edit"===e)return e===this.mode},getDefaultValue:function(){return{sid:"",menuCode:"",menuName:"",menuTitle:"",parentSid:"",menuType:"1",link:"0",menuProperties:"1",routingAddress:"",routingParam:"",componentPath:"",permissions:"",cache:"0",sort:"",visible:"0",status:"0",icon:"",creatorSid:"",createTime:"",editorSid:"",updateTime:"",remark:""}},loadProject:function(){var t=this;Object(d["f"])(null,null,null).then(function(e){t.$nextTick(function(){t.projectSelectItems=e.rows})}),Object(d["d"])("2,4",null).then(function(e){t.$nextTick(function(){t.menuSelectItems=Object(n["c"])(e.data)})})},open:function(e){this.addForm=this.getDefaultValue(),this.mode=e.mode,this.loadProject(),"edit"===this.mode?(this.spin=!0,this.getDataBySid(e.sid)):this.addForm.parentSid=e.sid,this.$refs.crm.open()},getDataBySid:function(e){var t=this;this.spin=!0,Object(d["e"])(e).then(function(e){null===e.data.parentSid&&(e.data.parentSid=void 0),t.addForm=e.data}).finally(function(){t.spin=!1})},handleSave:function(){var t=this;this.$refs.addForm.validate(function(e){e&&(t.saveLoading=!0,"insert"==t.mode?t.createMenu():t.editMenu())})},editMenu:function(){var t=this,e=this;void 0===this.addForm.parentSid&&(this.addForm.parentSid=""),Object(d["g"])(e.addForm).then(function(e){if(!Object(n["l"])(e))throw new Error(e.msg);t.$message.success("数据已更新"),o["a"].$emit("reloadData"),t.$refs.crm.close()}).catch(function(e){t.$message.error("请求异常：",e.message)}).finally(function(){t.saveLoading=!1})},createMenu:function(){var t=this;Object(d["a"])(this.addForm).then(function(e){if(!Object(n["l"])(e))throw new Error(e.msg);t.$message.success("数据已新增"),t.$refs.crm.close(),o["a"].$emit("reloadData")}).catch(function(e){t.$message.error("请求异常："+e.message)}).finally(function(){t.saveLoading=!1})},handleCancel:function(){this.$refs.crm.close()},selectedIcon:function(e){this.addForm.icon=e},loadMenuTreeData:function(e,t){var a=this;Object(d["d"])(e,null).then(function(e){a.treeData=Object(n["c"])(e.data)})}}},h=l,u=a("2877"),p=Object(u["a"])(h,i,s,!1,null,"5dd509eb",null);t["default"]=p.exports},af00:function(e,t,a){"use strict";a.r(t);var i=function(){var a=this,e=a.$createElement,i=a._self._c||e;return i("div",{attrs:{id:"iconSelectCard"}},[i("a-popover",{attrs:{title:"",trigger:"click"},model:{value:a.visible,callback:function(e){a.visible=e},expression:"visible"}},[i("a-input",{attrs:{placeholder:"单击文本框进行选择","allow-clear":"",readOnly:""},model:{value:a.icon,callback:function(e){a.icon=e},expression:"icon"}},[i("a-icon",{attrs:{slot:"prefix",type:a.icon},slot:"prefix"})],1),i("template",{slot:"content"},[i("div",{staticClass:"content-box"},[i("a-input",{attrs:{placeholder:"从下方选择图标或单击搜索","allow-clear":""},on:{change:a.handleChange},model:{value:a.sel,callback:function(e){a.sel=e},expression:"sel"}}),i("div",{staticClass:"icon-list-box",attrs:{id:"iconList"}},[a._l(a.iconShowList,function(t,e){return[i("a-button",{key:e,staticClass:"icon-item",attrs:{type:"link",icon:t,id:"iconItem"},on:{click:function(e){return a.selectThis(t)}}},[a._v(a._s(t))])]})],2)],1)])],2)],1)},s=[],r=(a("4de4"),{data:function(){return{iconList:["step-backward","step-forward","fast-backward","fast-forward","shrink","arrows-alt","down","up","left","right","caret-up","caret-down","caret-left","caret-right","up-circle","down-circle","left-circle","right-circle","double-right","double-left","vertical-left","vertical-right","vertical-align-top","vertical-align-middle","vertical-align-bottom","forward","backward","rollback","enter","retweet","swap","swap-left","swap-right","arrow-up","arrow-down","arrow-left","arrow-right","play-circle","up-square","down-square","left-square","right-square","login","logout","menu-fold","menu-unfold","border-bottom","border-horizontal","border-inner","border-outer","border-left","border-right","border-top","border-verticle","pic-center","pic-left","pic-right","radius-bottomleft","radius-bottomright","radius-upleft","radius-upright","fullscreen","fullscreen-exit","question","question-circle","plus","plus-circle","pause","pause-circle","minus","minus-circle","plus-square","minus-square","info","info-circle","exclamation","exclamation-circle","close","close-circle","close-square","check","check-circle","check-square","clock-circle","warning","issues-close","stop","edit","form","copy","scissor","delete","snippets","diff","highlight","align-center","align-left","align-right","bg-colors","bold","italic","underline","strikethrough","redo","undo","zoom-in","zoom-out","font-colors","font-size","line-height","dash","small-dash","sort-ascending","sort-descending","drag","ordered-list","unordered-list","radius-setting","column-width","column-height","area-chart","pie-chart","bar-chart","dot-chart","line-chart","radar-chart","heat-map","fall","rise","stock","box-plot","fund","sliders","android","apple","windows","ie","chrome","github","aliwangwang","dingding","weibo-square","weibo-circle","taobao-circle","html5","weibo","twitter","wechat","youtube","alipay-circle","taobao","skype","qq","medium-workmark","gitlab","medium","linkedin","google-plus","dropbox","facebook","codepen","code-sandbox","amazon","google","codepen-circle","alipay","ant-design","ant-cloud","aliyun","zhihu","slack","slack-square","behance","behance-square","dribbble","dribbble-square","instagram","yuque","alibaba","yahoo","reddit","sketch","account-book","alert","api","appstore","audio","bank","bell","book","bug","bulb","calculator","build","calendar","camera","car","carry-out","cloud","code","compass","contacts","container","control","credit-card","crown","customer-service","dashboard","database","dislike","environment","experiment","eye-invisible","eye","file-add","file-excel","file-exclamation","file-image","file-markdown","file-pdf","file-ppt","file-text","file-unknown","file-word","file-zip","file","filter","fire","flag","folder-add","folder","folder-open","frown","funnel-plot","gift","hdd","heart","home","hourglass","idcard","insurance","interaction","layout","like","lock","mail","medicine-box","meh","message","mobile","money-collect","pay-circle","notification","phone","picture","play-square","printer","profile","project","pushpin","property-safety","read","reconciliation","red-envelope","rest","rocket","safety-certificate","save","schedule","security-scan","setting","shop","shopping","skin","smile","sound","star","switcher","tablet","tag","tags","tool","thunderbolt","trophy","unlock","usb","video-camera","wallet","apartment","audit","barcode","bars","block","border","branches","ci","cloud-download","cloud-server","cloud-sync","cloud-upload","cluster","coffee","copyright","deployment-unit","desktop","disconnect","dollar","download","ellipsis","euro","exception","export","file-done","file-jpg","file-protect","file-sync","file-search","fork","gateway","global","gold","history","import","inbox","key","laptop","link","line","loading-3-quarters","loading","man","menu","monitor","more","number","percentage","paper-clip","pound","poweroff","pull-request","qrcode","reload","safety","robot","scan","search","select","shake","share-alt","shopping-cart","solution","sync","table","team","to-top","trademark","transaction","upload","user-add","user-delete","usergroup-add","user","usergroup-delete","wifi","woman"],iconShowList:[],sel:"",visible:!1}},model:{prop:"icon",event:"returnBack"},props:{icon:{type:String,default:function(){return""}}},mounted:function(){this.handleChange()},methods:{selectThis:function(e){this.sel="",this.handleChange(),this.$emit("selectedIcon",e),this.visible=!1},handleChange:function(){var t=this,e=[];""==this.sel?(this.$emit("selectedIcon",""),e=this.iconList):e=this.iconList.filter(function(e){return-1!==e.indexOf(t.sel)}),this.iconShowList=e}}}),n=r,d=(a("0369"),a("2877")),o=Object(d["a"])(n,i,s,!1,null,"e9e4a36e",null);t["default"]=o.exports},b808:function(e,t,a){},c855:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:" ",attrs:{id:"menuConfig"}},[a("div",{staticClass:"select-tree-box"},[a("div",{staticClass:"tree-box tree-first"},[a("a-spin",{attrs:{spinning:e.moduleSpin,tip:"正在加载模块数据..."}},[a("c-check-tree",{ref:"tree1",attrs:{propTreeData:e.tree1stData,checkedKeys:e.checked1stKeys,checkable:!1,disabled:"",placeholder:"选择下方的模块信息获搜索...",errorTip:"没有符合的数据供选择"},on:{onTreeSelect:e.change1stCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-second "},[a("a-spin",{attrs:{spinning:e.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree2",attrs:{propTreeData:e.tree2ndData,placeholder:"勾选下方版本数据或搜索版本",checkedKeys:e.checked2ndKeys,errorTip:"勾选版本信息前需要先选择最左侧的模块信息"},on:{changeCheckedKeys:e.change2ndCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-third "},[a("a-spin",{attrs:{spinning:e.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree3",attrs:{propTreeData:e.tree3rdData,errorTip:"勾选机构信息前需要先选择最左侧的模块信息",placeholder:"勾选下方机构数据或搜索机构",checkedKeys:e.checked3rdKeys},on:{changeCheckedKeys:e.change3rdCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-fourth "},[a("a-spin",{attrs:{spinning:e.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree4",attrs:{propTreeData:e.tree4thData,checkedKeys:e.checked4thKeys,errorTip:"勾选菜单信息前需要先选择最左侧的模块信息",placeholder:"勾选下方菜单信息或搜索菜单"},on:{changeCheckedKeys:e.change4thCheckedKeys}})],1)],1)]),a("div",{staticClass:"action-box"},[a("a-button",{attrs:{type:"primary",disabled:e.validCheck()},on:{click:e.mutilateInfoSelect}},[e._v("生成列表")])],1),e.alternativeList.length?a("div",{staticClass:"mul-box"},[a("div",{staticClass:"check-head"},[e._v(" 本次勾选数据组成的权限信息 ")]),a("div",{staticClass:"check-content"},[a("permissionResult",{attrs:{permissionData:e.alternativeList,dict:e.labelInfo}})],1)]):e._e()])},s=[],r=a("2909"),n=(a("d81d"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("25f0"),a("7db0"),a("88df")),d=a("6f21"),o=(a("f5ef"),function a(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0===s&&(s="key");var r={};return e.some(function(e){if(e[s]===i)return r=e,!0;if(e.children&&e.children.length>0){var t=a(e.children,i,s);if(void 0!==t)return r=t,!0}}),void 0===r&&(r=null),r}),c={props:{checked1stKeys:{type:Array,default:function(){return[]}},tree1stData:{type:Array,default:function(){return[]}}},components:{permissionResult:d["default"]},data:function(){return{userInfo:{},spin:!1,containerView:"preview",savaFlag:!1,moduleSpin:!1,loadingFlag:!1,treeData:[],tree2ndData:[],tree3rdData:[],tree4thData:[],dataTree:{},checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[],tempChecked:{checked1stKeys:[],checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[]},defaultExpandedKeys:[],selectedKeys:[],selectTableKeys:[],alternativeList:[],alternativeKeys:[],alternativeAllKeys:[],userReportMenu:[],labelInfo:{},indeterminateAlternativeList:!1,checkAllAlternativeList:!1,treeMenuList:[{menuKey:"insert",menuName:"新增",icon:"plus"},{menuKey:"edit",menuName:"修改",icon:"edit"},{menuKey:"delete",menuName:"删除",icon:"delete"}]}},mounted:function(){},methods:{onChange:function(e){this.indeterminateAlternativeList=!!e.length&&e.length<this.alternativeAllKeys.length,this.checkAllAlternativeList=e.length===this.alternativeAllKeys.length},onCheckAllChangeAlternativeList:function(){this.checkAllAlternativeList?this.alternativeKeys=[]:this.alternativeKeys=this.alternativeAllKeys,this.indeterminateAlternativeList=!1,this.checkAllAlternativeList=!this.checkAllAlternativeList},validCheck:function(){var e=this.checked2ndKeys,t=this.checked3rdKeys,a=this.checked4thKeys;return e.length<1||t.length<1||a.length<1},selectedToCheck:function(){var e=this.userReportMenu,t=this.checked2ndKeys,a=this.checked3rdKeys,i=this.checked4thKeys;this.tempChecked={checked2ndKeys:t,checked3rdKeys:a,checked4thKeys:i},e.map(function(e){t.push(e.reportSid),a.push(e.orgSid),i.push(e.menuSid)}),this.checked2ndKeys=Object(r["a"])(new Set(t)),this.checked3rdKeys=Object(r["a"])(new Set(a)),this.checked4thKeys=Object(r["a"])(new Set(i))},mutilateInfoSelect:function(){var r=this,n=this.userInfo.sid,d=this.$refs.tree1.getParentKey(this.checked1stKeys[0]),o=[],c=0,e=this.$refs.tree2.getCheckedFullInfo(),t=this.$refs.tree3.getCheckedFullInfo(),l=this.$refs.tree4.getCheckedFullInfo();e.map(function(i){var s=r.$refs.tree2.getCheckedInfo(i.key);t.map(function(a){l.map(function(e){var t=[i.title,a.title,e.title].toString().replaceAll(",","-");r.alternativeAllKeys.push(c),o.push({menuSid:e.key,projectSid:d,orgSid:a.key,reportSid:s.key,moduleSid:r.checked1stKeys[0],versionSid:i.versionSid,userSid:n,label:t,value:c,sid:c++})})})}),this.alternativeList=o,this.$emit("updateNewRecord",o)},handleCancel:function(){this.$refs.crm.close()},handleSave:function(){this.addRecord()},getFinalList:function(){var e=this.alternativeList;for(var t in e)delete e[t].label,delete e[t].value,delete e[t].index;return e},addRecord:function(){var t=this;this.savaFlag=!0,Object(n["d"])(this.userInfo.sid,this.checked1stKeys[0],alternativeList).then(function(e){t.$message.success("授权结果：".concat(e.msg))}).catch(function(e){t.$message.error("授权失败。".concat(e.message))}).finally(function(){t.savaFlag=!1})},init:function(){var e=this;this.treeData=[],this.tree2ndData=[],this.tree3rdData=[],this.tree4thData=[],this.dataTree={},this.checked2ndKeys=[],this.checked3rdKeys=[],this.checked4thKeys=[],this.defaultExpandedKeys=[],this.selectedKeys=[],this.selectTableKeys=[],this.alternativeList=[],this.alternativeKeys=[],this.alternativeAllKeys=[],this.indeterminateAlternativeList=!1,this.checkAllAlternativeList=!1,this.userReportMenu=[],this.$nextTick(function(){e.$refs.tree1.cleanSelect()})},open:function(e){this.userInfo=e,this.init()},change1stCheckedKeys:function(e){var i=this;if(this.$refs.tree1.setSelect([e]),this.$forceUpdate(),this.spin=!0,this.$emit("checked1stKeys",[e]),void 0===e||!e.length)return this.tree2ndData=[],this.tree3rdData=[],this.tree4thData=[],this.spin=!1,!1;Object(n["a"])(this.userInfo.sid,e).then(function(t){i.tree2ndData=t.data.report,i.tree3rdData=t.data.org,i.tree4thData=t.data.menu,i.dataTree=t.data;var a={};t.data.userReportMenu&&t.data.userReportMenu.length>0&&(i.userReportMenu=t.data.userReportMenu,t.data.userReportMenu.map(function(e){a.projectSid||(a.projectSid={}),a.versionSid||(a.versionSid={}),a.reportSid||(a.reportSid={}),a.moduleSid||(a.moduleSid={}),a.orgSid||(a.orgSid={}),a.menuSid||(a.menuSid={}),a.projectSid[e.projectSid]=o(i.tree1stData,e.projectSid),a.versionSid[e.versionSid]=o(i.tree2ndData,e.versionSid),a.reportSid[e.reportSid]=o(t.data.report,e.reportSid),a.moduleSid[e.moduleSid]=o(i.tree1stData,e.moduleSid),a.orgSid[e.orgSid]=o(t.data.org,e.orgSid),a.menuSid[e.menuSid]=o(t.data.menu,e.menuSid)}),i.labelInfo=a)}).finally(function(){i.spin=!1})},processLabelInfo:function(e){var t=this,a={};return e&&e.length>0&&e.map(function(e){a.projectSid||(a.projectSid={}),a.versionSid||(a.versionSid={}),a.reportSid||(a.reportSid={}),a.moduleSid||(a.moduleSid={}),a.orgSid||(a.orgSid={}),a.menuSid||(a.menuSid={}),a.projectSid[e.projectSid]=o(t.tree1stData,e.projectSid),a.versionSid[e.versionSid]=o(t.tree2ndData,e.versionSid),a.reportSid[e.reportSid]=o(t.tree2ndData,e.reportSid),a.moduleSid[e.moduleSid]=o(t.tree1stData,e.moduleSid),a.orgSid[e.orgSid]=o(t.tree3rdData,e.orgSid),a.menuSid[e.menuSid]=o(t.tree4thData,e.menuSid)}),a},change2ndCheckedKeys:function(e){this.checked2ndKeys=e},change3rdCheckedKeys:function(e){this.checked3rdKeys=e},change4thCheckedKeys:function(e){this.checked4thKeys=e},loadProjectTree:function(){var t=this;this.moduleSpin=!0,Object(n["b"])(this.userInfo.sid).then(function(e){t.tree1stData=e.data}).catch(function(e){t.$message.error(e.message)}).finally(function(){t.moduleSpin=!1})},onTreeSelect:function(e,t){this.formQuery({sid:e[0]})},handleOpenVersionManage:function(t){var e=this.tableData.content.find(function(e){return e.sid===t});this.$refs.ModalVersionManage.open(e)}}},l=c,h=(a("1314"),a("61f4"),a("d8ce"),a("2877")),u=Object(h["a"])(l,i,s,!1,null,"261326ac",null);t["default"]=u.exports},ce55:function(e,t,a){},d8ce:function(e,t,a){"use strict";a("5352")},deb5:function(e,t,a){"use strict";a("fa47")},e1727:function(e,t,a){"use strict";a("4370")},e481:function(e,t,a){"use strict";a("5859")},e8ace:function(e,t,a){"use strict";a("91c3")},ed7f:function(e,t,a){"use strict";a.r(t);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"report-permission-accredit-box",attrs:{id:"menuConfig"}},[a("c-resizable-modal",{ref:"crm",attrs:{modalWidth:"90%",title:t.title,maskClosable:!1}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.title)+" "),a("a-divider",{attrs:{type:"vertical"}}),t._v(" 当前模式："+t._s(t.useMode?"新增模式":"阅览模式")+" "),a("div",{staticClass:"switch-btn"},[a("a-popconfirm",{directives:[{name:"show",rawName:"v-show",value:t.isSwitchProtectShow,expression:"isSwitchProtectShow"}],attrs:{title:"当前新增模式下，您有已选择的数据但还没有提交，直接变更模式将会丢失数据。为了防止误操作，该开关暂时被屏蔽。您可以点击确定以解除这个保护。"},on:{confirm:t.onProtectConfirm}},[a("div",{staticClass:"protect-btn"},[a("a-icon",{class:t.isSwitchProtectShow?"lock-anime":"unlock-anime",attrs:{type:"lock"}})],1)]),a("a-switch",{model:{value:t.useMode,callback:function(e){t.useMode=e},expression:"useMode"}},[a("a-icon",{attrs:{slot:"checkedChildren",type:"edit"},slot:"checkedChildren"}),a("a-icon",{attrs:{slot:"unCheckedChildren",type:"eye"},slot:"unCheckedChildren"})],1)],1)],1),a("div",{staticClass:"container-box"},[a("transition-group",{attrs:{name:"slide-fade",appear:"",mode:"out-in"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"preview"==t.containerView,expression:"containerView=='preview'"}],key:"preview"},[a("div",{staticClass:"select-tree-box"},[a("div",{staticClass:"tree-box tree-first"},[a("a-spin",{attrs:{spinning:t.moduleSpin,tip:"正在加载模块数据..."}},[a("c-check-tree",{ref:"tree1",attrs:{propTreeData:t.tree1stData,checkedKeys:t.useMode?t.prepareAddObjects.checked1stKeys:t.checked1stKeys,checkable:!1,placeholder:"选择下方的模块信息获搜索...",errorTip:"没有符合的数据供选择"},on:{onTreeSelect:t.change1stCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-second "},[a("a-spin",{attrs:{spinning:t.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree2",attrs:{propTreeData:t.tree2ndData,placeholder:"勾选下方版本数据或搜索版本",checkedKeys:t.useMode?t.prepareAddObjects.checked2ndKeys:t.checked2ndKeys,errorTip:"勾选版本信息前需要先选择最左侧的模块信息",canSelectAll:!1,canJoint:!1},on:{onTreeSelect:t.select2ndKeys,changeCheckedKeys:t.change2ndCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-third "},[a("a-spin",{attrs:{spinning:t.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree3",attrs:{propTreeData:t.tree3rdData,errorTip:"勾选机构信息前需要先选择最左侧的模块信息",placeholder:"勾选下方机构数据或搜索机构",canSelectAll:!1,canJoint:!1,disabled:t.tree3rdDisabled,checkedKeys:t.useMode?t.prepareAddObjects.checked3rdKeys:t.checked3rdKeys},on:{onTreeSelect:t.select3rdKeys,changeCheckedKeys:t.change3rdCheckedKeys}})],1)],1),a("div",{staticClass:"tree-box tree-fourth "},[a("a-spin",{attrs:{spinning:t.spin,tip:"加载数据中..."}},[a("c-check-tree",{ref:"tree4",attrs:{propTreeData:t.tree4thData,checkedKeys:t.useMode?t.prepareAddObjects.checked4thKeys:t.checked4thKeys,canSelectAll:!1,canJoint:!1,errorTip:"勾选菜单信息前需要先选择最左侧的模块信息",disabled:t.tree4thDisabled,placeholder:"勾选下方菜单信息或搜索菜单"},on:{changeCheckedKeys:t.change4thCheckedKeys}})],1)],1)]),a("div",{staticClass:"action-box"},[t.useMode?a("a-button",{attrs:{type:"primary",disabled:t.validCheck()},on:{click:t.mutilateInfoSelect}},[t._v("生成列表")]):a("a-button",{attrs:{type:"primary"},on:{click:t.previewUpdate}},[t._v("生成预览")])],1),a("div",{staticClass:"mul-box"},[a("div",{staticClass:"check-head"},[t._v(" 当前的权限信息（"+t._s(t.useMode?"新增权限":"编辑已有权限")+"模式） ")]),a("div",{staticClass:"check-content"},[a("permissionResult",{attrs:{tableColumns:t.tableColumns,permissionData:t.useMode?t.prepareAddReportMenu:t.userReportMenu,dict:t.labelInfo},on:{deletePermissionInfo:t.deletePermissionInfo}})],1)])]),a("add-panel",{directives:[{name:"show",rawName:"v-show",value:"add"==t.containerView,expression:"containerView=='add'"}],key:"add",ref:"addPanel",attrs:{checked1stKeys:t.checked1stKeys,tree1stData:t.tree1stData},on:{checked1stKeys:t.getChecked1stKeys,updateNewRecord:t.updateNewRecord}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{on:{click:t.handleCancel}},[t._v("取 消")]),a("a-button",{attrs:{type:"primary",loading:t.saveFlag},on:{click:t.handleSave}},[t._v(" "+t._s(t.useMode?"创建当前新":"提交当前变更的")+"权限信息 ")])],1)])],1)},s=[],r=a("2909"),n=(a("99af"),a("d81d"),a("d3b7"),a("25f0"),a("c740"),a("a434"),a("6062"),a("3ca3"),a("ddb0"),a("caad"),a("2532"),a("7db0"),a("6f21")),d=a("88df"),o=a("c855"),u=(a("f5ef"),function a(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0===s&&(s="key");var r={};return e.some(function(e){if(e[s]===i)return r=e,!0;if(e.children&&e.children.length>0){var t=a(e.children,i,s);if(void 0!==t)return r=t,!0}}),void 0===r&&(r=null),r}),c={data:function(){return{useMode:!1,switchProtectFlag:!0,userInfo:{},spin:!1,containerView:"preview",saveFlag:!1,moduleSpin:!1,loadingFlag:!1,tree1stData:[],tree2ndData:[],tree3rdData:[],tree4thData:[],dataTree:{},checked1stKeys:[],checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[],select2ndKey:"",select3rdKey:"",tree4thDisabled:!0,tree3rdDisabled:!0,tempChecked:{checked1stKeys:[],checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[]},prepareAddObjects:{checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[]},defaultExpandedKeys:[],tableColumns:[{key:"index",dataIndex:"index",title:"序号"},{key:"moduleSid",dataIndex:"moduleSid",title:"模块",hasSlot:!0},{key:"reportSid",dataIndex:"reportSid",title:"报表",hasSlot:!0},{key:"versionSid",dataIndex:"versionSid",title:"版本",hasSlot:!0},{key:"orgSid",dataIndex:"orgSid",title:"机构",hasSlot:!0},{key:"menuSid",dataIndex:"menuSid",title:"菜单",hasSlot:!0}],selectedKeys:[],selectTableKeys:[],alternativeList:[],alternativeKeys:[],alternativeAllKeys:[],userReportMenu:[],prepareAddReportMenu:[],labelInfo:{versionSid:{},reportSid:{},moduleSid:{},orgSid:{},menuSid:{}},readyDeleteRecords:[],indeterminateAlternativeList:!1,checkAllAlternativeList:!1}},computed:{title:function(){var e=this.userInfo,t=e.userName,a=e.userCode;return"对用户 “".concat(t,"（").concat(a,"）” 的报表权限授予 //没做完TODO")},isSwitchProtectShow:function(){var e=this.switchProtectFlag,t=this.prepareAddObjects,a=t.checked2ndKeys,i=t.checked3rdKeys,s=t.checked4thKeys,r=a.length>0||i.length>0||s.length>0;return e&&r}},mounted:function(){},methods:{onProtectConfirm:function(){var e=this;setTimeout(function(){e.switchProtectFlag=!1},700)},mutilateInfoSelect:function(){var r=this,n=this.userInfo.sid,d=this.$refs.tree1.getParentKey(this.checked1stKeys[0]),o=[],c=0,e=this.$refs.tree2.getCheckedFullInfo(),t=this.$refs.tree3.getCheckedFullInfo(),l=this.$refs.tree4.getCheckedFullInfo(),h=this;e.map(function(i){var s=r.$refs.tree2.getCheckedInfo(i.key);t.map(function(a){l.map(function(e){var t=[i.title,a.title,e.title].toString().replaceAll(",","-");h.labelInfo.reportSid[i.key]||(h.labelInfo.reportSid[i.key]=i.title),h.labelInfo.versionSid[i.versionSid]||(h.labelInfo.versionSid[i.versionSid]=u(r.tree2ndData,i.versionSid).title),h.labelInfo.orgSid[a.key]||(h.labelInfo.orgSid[a.key]=a.title),h.labelInfo.menuSid[e.key]||(h.labelInfo.menuSid[e.key]=e.title),r.alternativeAllKeys.push(c),o.push({menuSid:e.key,projectSid:d,orgSid:a.key,reportSid:s.key,moduleSid:r.checked1stKeys[0],versionSid:i.versionSid,userSid:n,label:t,value:c,sid:c++})})})}),this.prepareAddReportMenu=o},onUseModeChange:function(e){this.$createElement;var t=this,a=this.prepareAddObjects,i=a.checked2ndKeys,s=a.checked3rdKeys,r=a.checked4thKeys,n=i.length>0||s.length>0||r.length>0;!e&&n?this.$confirm({title:"模式变更提醒",content:function(e){return e("p",["当前新增模式下，您有已选择的数据但还没有提交。模式变更回阅览模式后，您刚才选择的",e("span",{class:"textRed"},["信息将不会被保存"]),"，确认变更模式吗？"])},onOk:function(){t.useMode=e},onCancel:function(){t.useMode=!e}}):t.useMode=e},deletePermissionInfo:function(t){this.$createElement;var i=this;this.$confirm({title:"权限信息预删除提示",content:function(e){return e("div",["您选择了",t.length,"条信息正在进行删除操作。该操作为",e("span",{class:"textRed"},["预删除"]),"，当您点击权限配置框的保存按钮时，删除的信息才会生效。",e("p",["是否确认预删除选中权限？"])])},onOk:function(){var a=i.userReportMenu;t.map(function(t){var e=a.findIndex(function(e){return e.sid===t});-1!==e&&i.userReportMenu.splice(e,1)})},onCancel:function(){}})},updateNewRecord:function(e){this.userReportMenu=Object(r["a"])(new Set(this.userReportMenu.concat(e)))},getChecked1stKeys:function(e){this.checked1stKeys=e},onTabsChange:function(e){},onChange:function(e){this.indeterminateAlternativeList=!!e.length&&e.length<this.alternativeAllKeys.length,this.checkAllAlternativeList=e.length===this.alternativeAllKeys.length},onCheckAllChangeAlternativeList:function(){this.checkAllAlternativeList?this.alternativeKeys=[]:this.alternativeKeys=this.alternativeAllKeys,this.indeterminateAlternativeList=!1,this.checkAllAlternativeList=!this.checkAllAlternativeList},validCheck:function(){var e=this.checked2ndKeys,t=this.checked3rdKeys,a=this.checked4thKeys,i=0==e.length&&0==t.length&&0==a.length||e.length>0&&t.length>0&&a.length>0;return!i},selectedToCheck:function(){var i=this,e=this.userReportMenu,s=this.checked2ndKeys,t=this.checked3rdKeys,a=this.checked4thKeys;this.tempChecked={checked2ndKeys:s,checked3rdKeys:t,checked4thKeys:a},e.map(function(e){var t=e.reportSid,a=i.$refs.tree2.getCheckedInfo(t);void 0!==a&&e.versionSid===a.versionSid&&s.push(e.reportSid)}),this.checked2ndKeys=Object(r["a"])(new Set(s)),this.$refs.tree2.onChangeExpand({target:{checked:!0}})},previewUpdate:function(){if(this.validCheck())return this.$message.warning("权限配置不完整，无法生成预览。"),!1;var a=this.userReportMenu;this.readyDeleteRecords.map(function(e){var t=a.indexOf(e);-1!==t&&a.splice(t,1)}),this.userReportMenu=a},handleCancel:function(){this.$refs.crm.close()},handleSave:function(){this.addRecord()},addRecord:function(){var t=this,e=this.userReportMenu,a=this.checked1stKeys;for(var i in e)delete e[i].label,delete e[i].value,delete e[i].index;this.saveFlag=!0;var s=this.$refs.addPanel.getFinalList(),r=e.concat(s);Object(d["d"])(this.userInfo.sid,a[0],r).then(function(e){t.$message.success("授权结果：".concat(e.msg,"。1.5秒后跳转到预览面板显示结果")),setTimeout(function(){t.$refs.addPanel.init(),t.init(),t.containerView="preview"},1500)}).catch(function(e){t.$message.error("授权失败。".concat(e.message))}).finally(function(){t.saveFlag=!1})},init:function(){var e=this;this.tree2ndData=[],this.tree3rdData=[],this.tree4thData=[],this.dataTree={},this.checked1stKeys=[],this.checked2ndKeys=[],this.checked3rdKeys=[],this.checked4thKeys=[],this.defaultExpandedKeys=[],this.selectedKeys=[],this.selectTableKeys=[],this.alternativeList=[],this.alternativeKeys=[],this.alternativeAllKeys=[],this.indeterminateAlternativeList=!1,this.checkAllAlternativeList=!1,this.userReportMenu=[],this.prepareAddReportMenu=[],this.prepareAddObjects={checked2ndKeys:[],checked3rdKeys:[],checked4thKeys:[]},this.$nextTick(function(){e.$refs.tree1.cleanSelect()})},open:function(e){this.containerView="",this.containerView="preview",this.userInfo=e,this.useMode=!1,this.$refs.crm.open(),this.init(),this.loadProjectTree()},change2ndCheckedKeys:function(e,t,a){var i=this,s=this.useMode;if(s)this.prepareAddObjects.checked2ndKeys=e;else if("undefined"==typeof t||this.validCheckedNodeIsPresent(this.tempChecked.checked2ndKeys,t))if(this.checked2ndKeys=e,a){var r=[];this.readyDeleteRecords.map(function(e){t===e.reportSid&&r.push(e)}),r.map(function(e){var t=i.readyDeleteRecords.indexOf(e);-1!==t&&i.readyDeleteRecords.splice(t,1)})}else this.userReportMenu.map(function(e){e.reportSid===t&&i.readyDeleteRecords.push(e)}),t==this.select2ndKey&&(this.checked3rdKeys=[],this.checked4thKeys=[])},generateData:function(){},change1stCheckedKeys:function(e){var i=this;if(this.spin=!0,this.checked1stKeys=[e],this.labelInfo.moduleSid[e]||(this.labelInfo.moduleSid[e]=u(this.tree1stData,e).title),void 0===e||!e.length)return this.tree2ndData=[],this.tree3rdData=[],this.tree4thData=[],this.spin=!1,!1;Object(d["a"])(this.userInfo.sid,e).then(function(t){i.tree2ndData=t.data.report,i.tree3rdData=t.data.org,i.tree4thData=t.data.menu,i.dataTree=t.data;var a={};t.data.userReportMenu&&t.data.userReportMenu.length>0&&(i.userReportMenu=t.data.userReportMenu,t.data.userReportMenu.map(function(e){a.projectSid||(a.projectSid={}),a.versionSid||(a.versionSid={}),a.reportSid||(a.reportSid={}),a.moduleSid||(a.moduleSid={}),a.orgSid||(a.orgSid={}),a.menuSid||(a.menuSid={}),a.projectSid[e.projectSid]=u(i.tree1stData,e.projectSid),a.versionSid[e.versionSid]=u(t.data.report,e.versionSid),a.reportSid[e.reportSid]=u(t.data.report,e.reportSid),a.moduleSid[e.moduleSid]=u(i.tree1stData,e.moduleSid),a.orgSid[e.orgSid]=u(t.data.org,e.orgSid),a.menuSid[e.menuSid]=u(t.data.menu,e.menuSid)}),i.labelInfo=a)}).then(function(){i.selectedToCheck(),i.tree3rdDisabled=!0,i.tree4thDisabled=!0}).finally(function(){i.spin=!1})},validCheckedNodeIsPresent:function(e,t){if(this.useMode)return!0;if(void 0===t||void 0===e)return!1;var a=e.includes(t);return a||this.$message.warning("无法操作先前未拥有的、或者变更删除的权限节点"),a},select2ndKeys:function(t){var a=this;this.select2ndKey=t;var i=[],s=[];this.useMode?this.tree3rdDisabled=!1:(this.validCheckedNodeIsPresent(this.tempChecked.checked2ndKeys,t)?this.userReportMenu.map(function(e){e.reportSid===t&&(i.push(e.orgSid),s.push(e.menuSid),a.tree3rdDisabled=!1)}):(this.tree4thDisabled=!0,this.tree3rdDisabled=!0),i=Object(r["a"])(new Set(i)),s=Object(r["a"])(new Set(s)),this.tempChecked.checked3rdKeys=i,this.tempChecked.checked4thKeys=s,this.checked3rdKeys=i,this.checked4thKeys=s)},select3rdKeys:function(t){var a=this;this.select3rdKey=t;var i=[];this.useMode?this.tree4thDisabled=!1:(this.validCheckedNodeIsPresent(this.tempChecked.checked3rdKeys,t)?this.userReportMenu.map(function(e){e.orgSid===t&&(i.push(e.menuSid),a.tree4thDisabled=!1)}):this.tree4thDisabled=!0,i=Object(r["a"])(new Set(i)),this.tempChecked.checked4thKeys=i,this.checked4thKeys=i)},change3rdCheckedKeys:function(e,t,a){var i=this,s=this.useMode;if(s)this.prepareAddObjects.checked3rdKeys=e;else{var r=this.select2ndKey,n=this.select3rdKey;if(this.validCheckedNodeIsPresent(this.tempChecked.checked3rdKeys,t))if(this.checked3rdKeys=e,this.$forceUpdate(),a){var d=[];this.readyDeleteRecords.map(function(e){t===e.orgSid&&r===e.reportSid&&d.push(e)}),d.map(function(e){var t=i.readyDeleteRecords.indexOf(e);-1!==t&&i.readyDeleteRecords.splice(t,1)})}else this.userReportMenu.map(function(e){e.orgSid===t&&r===e.reportSid&&i.readyDeleteRecords.push(e)}),n===t&&(this.checked4thKeys=[])}},change4thCheckedKeys:function(e,t,a){var i=this,s=this.useMode;if(s)this.prepareAddObjects.checked4thKeys=e;else{var r=this.select2ndKey,n=this.select3rdKey;if(this.validCheckedNodeIsPresent(this.tempChecked.checked4thKeys,t))if(this.checked4thKeys=e,a){var d=[];this.readyDeleteRecords.map(function(e){t===e.menuSid&&r===e.reportSid&&d.push(e)}),d.map(function(e){var t=i.readyDeleteRecords.indexOf(e);-1!==t&&i.readyDeleteRecords.splice(t,1)})}else this.userReportMenu.map(function(e){e.menuSid===t&&n===e.orgSid&&i.readyDeleteRecords.push(e)})}},loadProjectTree:function(){var t=this;this.moduleSpin=!0,Object(d["b"])(this.userInfo.sid).then(function(e){t.tree1stData=e.data}).catch(function(e){t.$message.error(e.message)}).finally(function(){t.moduleSpin=!1})},rightClickMenuItem:function(e,t){switch(t){case"insert":this.handleAdd(e);break;case"edit":this.handleEdit(e);break;case"delete":this.handleDelete([e]);break}},onTreeSelect:function(e,t){this.formQuery({sid:e[0]})},handleOpenVersionManage:function(t){var e=this.tableData.content.find(function(e){return e.sid===t});this.$refs.ModalVersionManage.open(e)}},components:{addPanel:o["default"],permissionResult:n["default"]}},l=c,h=(a("9cc7"),a("e1727"),a("e481"),a("deb5"),a("2877")),p=Object(h["a"])(l,i,s,!1,null,"407e5f00",null);t["default"]=p.exports},f859:function(e,t,a){"use strict";a("2a5a")},fa47:function(e,t,a){}}]);