(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app~744abbd2"],{"0070":function(e,t,a){"use strict";a.r(t),a.d(t,"orgLevelParam",function(){return n}),a.d(t,"orgTypeParam",function(){return r}),a.d(t,"statusParam",function(){return i}),a.d(t,"delFlagParam",function(){return s});var r={1:"机构",2:"部门"},n={1:"总行",2:"分行",3:"支行",4:"网点"},i={0:"正常",1:"停用"},s={0:"存在",2:"删除"}},"0fa1":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"orgDetail"}},[a("c-resizable-modal",{ref:"crm",attrs:{title:"菜单设置"}},[a("h4",[e._v(" 机构名称："+e._s(e.orgInfo.orgName)+" "),a("a-divider",{attrs:{type:"vertical"}}),e._v(" 机构编号："+e._s(e.orgInfo.orgCode)+" ")],1),a("a-spin",{attrs:{tip:"正在请求数据...",spinning:e.spinning}},[a("c-check-tree",{attrs:{propTreeData:e.treeData,checkedKeys:e.checkedKeys},on:{changeCheckedKeys:e.changeCheckedKeys}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:updateOrgMenuRel"],expression:"['system:organization:updateOrgMenuRel']"}],staticClass:"margin-btn",attrs:{type:"primary",icon:"check",loading:e.saveLoading},on:{click:e.handleSave}},[e._v("更 新")])],1)],1)],1)},n=[],i=(a("d3b7"),a("25f0"),a("7e6c")),s=a("ed08"),o={data:function(){return{isSelectAll:!1,saveLoading:!1,treeData:[],checkedKeys:[],defaultExpandedKeys:[],spinning:!0,orgInfo:{}}},methods:{reset:function(){this.defaultExpandedKeys=[],this.checkedKeys=[],this.treeData=[]},open:function(e){this.orgInfo=e,this.reset(),this.spinning=!0,this.getTreeData(),this.$refs.crm.open()},changeCheckedKeys:function(e){this.checkedKeys=e},handleSave:function(){var t=this;this.saveLoading=!0;var e={orgSid:this.orgInfo.sid,menuSid:this.checkedKeys.toString(),isRelation:"0"};Object(i["l"])(e).then(function(e){if(!Object(s["l"])(e))throw new Error(e.msg);t.$message.success("机构与菜单的信息更新成功"),t.$refs.crm.close()}).catch(function(e){t.$message.error(e.message)}).finally(function(){t.saveLoading=!1})},checkKeys:function(e){var t=[];for(var a in e){var r=e[a];"0"===r.isChecked&&t.push(r.key),r.children&&r.children.length>0&&t.push.apply(t,this.checkKeys(r.children))}return t},getTreeData:function(){var t=this,e=this.orgInfo.sid;Object(i["f"])(e).then(function(e){t.treeData=e.data,t.checkedKeys=t.checkKeys(e.data),t.spinning=!1})},handleCancel:function(){var e=this;this.$confirm({title:"表单存在内容",onOk:function(){e.$message.info("触发关闭事件"),e.$refs.crm.close()},onCancel:function(){}})}}},l=o,d=a("2877"),c=Object(d["a"])(l,r,n,!1,null,"666a460a",null);t["default"]=c.exports},"1e7c":function(e,t,a){"use strict";a("9905")},"262e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"menuAccr"}},[a("c-resizable-modal",{ref:"crm",attrs:{title:"机构与模块版本关系授权"}},[a("h4",[e._v(" 当前机构："+e._s(e.pInfos.orgName)+"（"+e._s(e.pInfos.orgCode)+"） ")]),a("a-spin",{attrs:{tip:"正在请求数据...",spinning:e.spinning}},[a("c-check-tree",{attrs:{propTreeData:e.treeData,checkedKeys:e.checkedKeys},on:{changeCheckedKeys:e.changeCheckedKeys}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{staticClass:"margin-btn",attrs:{type:"info",icon:"close"},on:{click:e.handleCancel}},[e._v("取 消")]),e.treeData.length>0?a("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:updateOrganizationModuleRel"],expression:"['system:organization:updateOrganizationModuleRel']"}],staticClass:"margin-btn",attrs:{type:"primary",icon:"check",loading:e.saveLoading},on:{click:e.handleSave}},[e._v("更 新")]):e._e()],1)],1)],1)},n=[],i=(a("d3b7"),a("25f0"),a("7e6c")),s=(a("ed08"),{data:function(){return{saveLoading:!1,pInfos:{},spinning:!0,treeData:[],checkedKeys:[]}},methods:{reset:function(){this.leftSourceData=[],this.rightTargetKeys=[],this.saveLoading=!1,this.checkedKeys=[],this.treeData=[]},open:function(e){this.pInfos=e,this.reset(),this.loadTreeData(),this.spinning=!0,this.$refs.crm.open()},loadTreeData:function(){var t=this,e=this.pInfos.sid;Object(i["g"])(e).then(function(e){t.treeData=e.data,t.checkedKeys=t.checkKeys(t.treeData)}).catch(function(e){t.$message.error(e.message)}).finally(function(){t.spinning=!1})},checkKeys:function(e){var t=[],a=[];for(var r in e){var n=e[r];"0"===n.isChecked&&(t.push(n.key),a.push(n.title)),n.children&&n.children.length>0&&t.push.apply(t,this.checkKeys(n.children))}return t},handleSave:function(){var t=this;this.saveLoading=!0;var a=this,e={orgSid:this.pInfos.sid.toString(),moduleSid:this.checkedKeys.toString(),isRelation:"0"};Object(i["m"])(e).then(function(e){t.$message.success("机构与模块信息更新结果：".concat(e.msg)),a.$refs.crm.close()}).catch(function(e){t.$message.error("错误："+e.message)}).finally(function(){t.saveLoading=!1})},changeCheckedKeys:function(e){this.checkedKeys=e},handleCancel:function(){var e=this;e.$refs.crm.close()}}}),o=s,l=a("2877"),d=Object(l["a"])(o,r,n,!1,null,"2ed68c32",null);t["default"]=d.exports},"678b":function(e,t,a){"use strict";a.r(t);var r=function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("div",{staticClass:"org-config white-back-box",attrs:{id:"menuConfig"}},[r("c-tree-with-self",{attrs:{treeData:a.treeData,selectedKeys:a.selectedKeys,treeMenuList:a.treeMenuList},on:{rightClickMenuItem:a.rightClickMenuItem,onTreeSelect:a.onTreeSelect}},[r("div",{attrs:{slot:"selfContent"},slot:"selfContent"},[r("c-query-form-table",{attrs:{searchParams:a.par,tableData:a.tableData,tableColumns:a.tableColumns,needTableCheckList:!0,selectTableKeys:a.selectTableKeys,loadingFlag:a.loadingFlag},on:{selectTableKeysChangeFromQFT:a.selectTableKeysChangeFromQFT,formQuery:a.formQuery,dbClick:a.dbClick,reloadData:a.reloadData},scopedSlots:a._u([{key:"orgType",fn:function(e){return r("span",{},[r("span",[a._v(a._s(a.orgTypeParam[e.data.orgType]))])])}},{key:"orgLevel",fn:function(e){return r("span",{},[r("span",[a._v(a._s(a.orgLevelParam[e.data.orgLevel]))])])}},{key:"status",fn:function(e){return r("span",{},[r("span",[a._v(a._s(a.statusParam[e.data.status]))])])}},{key:"delFlag",fn:function(e){return r("span",{},[r("span",[a._v(a._s(a.delFlagParam[e.data.delFlag]))])])}},{key:"tableActionBox",fn:function(t){return[r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:edit"],expression:"['system:organization:edit']"}],attrs:{type:"link"},on:{click:function(e){return a.handleEdit(t.data.sid)}}},[a._v("修改")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:delete"],expression:"['system:organization:delete']"}],attrs:{type:"link"},on:{click:function(e){return a.handleEdit([t.data.sid])}}},[a._v("删除")])]}}])},[r("template",{staticClass:"btn-box",slot:"functionBtnBox"},[r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:add"],expression:"['system:organization:add']"}],staticClass:"margin-box",attrs:{type:"primary",icon:"plus"},on:{click:function(e){return a.handleAdd(null)}}},[a._v("新增")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:edit"],expression:"['system:organization:edit']"}],staticClass:"margin-box",attrs:{type:"primary",icon:"edit",disabled:1!==a.selectTableKeys.length},on:{click:function(e){return a.handleEdit(a.selectTableKeys[0])}}},[a._v("修改")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:delete"],expression:"['system:organization:delete']"}],staticClass:"margin-box",attrs:{type:"primary",disabled:a.selectTableKeys.length<1,icon:"delete"},on:{click:function(e){return a.handleDelete(a.selectTableKeys)}}},[a._v("删除")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:setFailure"],expression:"['system:organization:setFailure']"}],staticClass:"margin-box",attrs:{type:"primary",disabled:a.selectTableKeys.length<1,icon:"delete"},on:{click:function(e){return a.handleSetFailure(a.selectTableKeys)}}},[a._v("设置失效")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:getOrgMenu"],expression:"['system:organization:getOrgMenu']"}],staticClass:"margin-box",attrs:{type:"primary",disabled:1!==a.selectTableKeys.length,icon:"menu"},on:{click:function(e){return a.handleOpenMenuManage(a.selectTableKeys[0])}}},[a._v("菜单管理")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:import"],expression:"['system:organization:import']"}],staticClass:"margin-box",attrs:{type:"primary",icon:"import"},on:{click:a.handleOpenImportBox}},[a._v("导入")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:export"],expression:"['system:organization:export']"}],staticClass:"margin-box",attrs:{type:"primary",loading:a.isExportBtnLoad,icon:"export"},on:{click:a.handleExportOrgData}},[a._v("导出")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization:exportTemplate"],expression:"['system:organization:exportTemplate']"}],staticClass:"margin-btn",attrs:{type:"primary",loading:a.isExportTplBtnLoad,icon:"file-excel"},on:{click:a.handleExportTemplate}},[a._v("导出模板")]),r("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:organization::getOrganizationModule"],expression:"['system:organization::getOrganizationModule']"}],staticClass:"margin-btn",attrs:{type:"primary",disabled:1!==a.selectTableKeys.length,icon:"file-excel"},on:{click:function(e){return a.handleOpenModuleAccredit(a.selectTableKeys[0])}}},[a._v("模块关系授权")])],1)],2)],1)]),r("org-detail-modal",{ref:"orgDetailModal"}),r("modal-menu-manage",{ref:"modalMenuManage"}),r("file-import-modal",{ref:"fileImportModal",on:{readToPostFile:a.readToPostFile,uploadSuccess:a.uploadSuccess}}),r("ModalModuleAccredit",{ref:"ModalModuleAccredit"})],1)},n=[],i=(a("7db0"),a("d3b7"),a("25f0"),a("99af"),a("0070")),s=a("7e6c"),o=a("ed08"),l=a("262e"),d=a("c28a"),c=a("f305"),m=a("0fa1"),u=a("f5ef"),p={data:function(){return{orgLevelParam:i["orgLevelParam"],orgTypeParam:i["orgTypeParam"],statusParam:i["statusParam"],delFlagParam:i["delFlagParam"],selectTableKeys:[],loadingFlag:!1,isExportTplBtnLoad:!1,isExportBtnLoad:!1,queryParam:{},par:[{name:"orgCode",label:"机构编号",type:"input"},{name:"orgName",label:"机构名称",type:"input"},{name:"aliasName",label:"机构简称",type:"input"},{name:"orgLevel",label:"机构级别",type:"select",selectList:[{key:"1",value:"总行"},{key:"2",value:"分行"},{key:"3",value:"支行"},{key:"4",value:"网点"}]},{name:"orgType",label:"机构类型",type:"select",selectList:[{key:"1",value:"机构"},{key:"2",value:"部门"}]},{name:"sort",label:"排序",type:"input"},{name:"parentSid",label:"上级机构",type:"input"},{name:"status",label:"状态",type:"select",selectList:[{key:"0",value:"正常"},{key:"1",value:"停用"}]},{name:"delFlag",label:"删除标志",type:"select",selectList:[{key:"0",value:"存在"},{key:"2",value:"删除"}],default:"0"},{name:"beginDate",label:"生效日期",type:"date"},{name:"endDate",label:"失效日期",type:"date"},{name:"creatorSid",label:"创建者编号",type:"input"},{name:"createTime",label:"创建时间",type:"datetime"},{name:"editorSid",label:"修改者编号",type:"input"},{name:"updateTime",label:"修改时间",type:"datetime"},{name:"remark",label:"备注",type:"input"}],tableData:{pageSize:10,pageNum:1,totalPages:1,totalSize:1,content:[]},orgTree:[],value:void 0,treeData:[],tableColumns:[{title:"机构编号",dataIndex:"orgCode",key:"orgCode"},{title:"机构简称",dataIndex:"aliasName",key:"aliasName"},{title:"机构级别",dataIndex:"orgLevel",key:"orgLevel",hasSlot:!0},{title:"机构类型",dataIndex:"orgType",key:"orgType",hasSlot:!0},{title:"机构名称",dataIndex:"orgName",key:"orgName"},{title:"排序",dataIndex:"sort",key:"sort"},{title:"负责人编号",dataIndex:"leaderSid",key:"leaderSid"},{title:"上级机构/部门编号",dataIndex:"parentSid",key:"parentSid"},{title:"上级机构/部门",dataIndex:"parentCode",key:"parentCode"},{title:"上级机构/部门编号名称",dataIndex:"parentName",key:"parentName"},{title:"机构状态",dataIndex:"status",key:"status",hasSlot:!0},{title:"删除标志",dataIndex:"delFlag",key:"delFlag",hasSlot:!0},{title:"生效日期",dataIndex:"beginDate",key:"beginDate"},{title:"失效日期",dataIndex:"endDate",key:"endDate"},{title:"创建者编号",dataIndex:"creatorSid",key:"creatorSid"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"修改者编号",dataIndex:"editorSid",key:"editorSid"},{title:"修改时间",dataIndex:"updateTime",key:"updateTime"},{title:"备注",dataIndex:"remark",key:"remark"}],expandedKeys:[],selectedKeys:[],treeMenuList:[{menuKey:"insert",menuName:"新增"}],autoExpandParent:!0,deleteType:!1}},mounted:function(){this.treeData=this.tableData.content;var e=this,t=this.tableData,a=t.pageNum,r=t.pageSize;this.handleLoadData({pageNum:a,pageSize:r},{delFlag:"0"}),u["a"].$on("reloadData",function(){e.reloadData({},{delFlag:"0"})})},methods:{handleOpenModuleAccredit:function(t){if(!t.length)return this.$message.warning("只能选择1项数据进行操作"),!1;var e=this.tableData.content.find(function(e){return e.sid===t});e||this.$message.error("执行出错"),this.$refs.ModalModuleAccredit.open(e)},rightClickMenuItem:function(e,t){switch(t){case"1":this.handleAdd(e);break;case"2":this.handleEdit(e);break;case"3":this.handleDelete([e]);break}},onTreeSelect:function(e,t){this.formQuery({sid:e[0]})},handleLoadData:function(e,t){var a=this;this.loadTreeData(),this.selectTableKeys=[],"{}"===JSON.stringify(e)&&(e.pageNum=this.tableData.pageNum,e.pageSize=this.tableData.pageSize),this.loadingFlag=!0,Object(s["e"])(e.pageNum,e.pageSize,t).then(function(e){if(!Object(o["l"])(e))throw new Error(e.msg);a.$nextTick(function(){a.tableData.content=e.rows,a.tableData.totalSize=e.total,a.tableData.totalPages=Math.ceil(a.tableData.totalSize/a.tableData.pageSize)})}).catch(function(e){a.$message.error(e.message)}).finally(function(){setTimeout(function(){a.loadingFlag=!1},500)})},loadTreeData:function(){var t=this;Object(s["i"])("all",null).then(function(e){t.treeData=Object(o["c"])(e.data)})},getOrgInfoBySid:function(e){var t=this.tableData.content,a=0;for(a in t)if(t[a]["sid"]===e)break;return t[a]},handleOpenMenuManage:function(e){var t=this.getOrgInfoBySid(e);this.$refs.modalMenuManage.open(t)},handleDelete:function(t){var a=this,e=this.$createElement,r=e("div",null,[e("p",null,[e("span",null,"即将删除".concat(t.length,"项数据，")),e("span",{style:"color:red"},"如果包含子项，也将一并删除。 ")]),e("span",null,"请选择删除的类型。 "),e("a-switch",{on:{click:function(){},change:function(e){a.deleteType=e}},attrs:{checkedChildren:"物理删除",unCheckedChildren:"逻辑删除"}},"")]);this.$confirm({title:"删除机构数据确认",content:r,okType:"danger",closable:!0,onOk:function(){var e=a.deleteType?"Physical":"Logic";a.confirmOkToDelete(t,e)}})},confirmOkToDelete:function(t,a){var r=this,n=this,e={id:t.toString(),type:a,countNum:t.length};Object(s["b"])(e).then(function(e){if(!Object(o["l"])(e))throw new Error(e.msg);n.reloadData({}),n.$message.success("已".concat("Logic"==a?"逻辑":"物理","删除").concat(t.length,"项数据"))}).catch(function(e){r.$message.error("请求错误："+e.message)})},reloadData:function(e){if("{}"!==JSON.stringify(e)){var t=e.pageNum,a=e.pageSize;this.tableData.pageNum=t,this.tableData.pageSize=a}this.handleLoadData({},null)},formQuery:function(e){this.queryParam=e,this.handleLoadData({},e)},dbClick:function(e){this.handleEdit(e.sid)},handleAdd:function(e){this.$refs.orgDetailModal.open({mode:"insert",sid:e})},handleEdit:function(e){this.$refs.orgDetailModal.open({mode:"edit",sid:e})},handleSetFailure:function(t){var a=this,r=this;Object(s["k"])(t).then(function(e){if(!Object(o["l"])(e))throw new Error(e.msg);r.reloadData({}),r.$message.success("已设置失效".concat(t.length,"项数据"))}).catch(function(e){a.$message.error("错误："+e.message)})},selectTableKeysChangeFromQFT:function(e){this.selectTableKeys=e},handleOpenImportBox:function(){this.$refs.fileImportModal.open()},readToPostFile:function(e){var a=this;Object(s["j"])(e).then(function(e){var t=Object(o["l"])(e);a.$refs.fileImportModal.showImportResult(e,t)}).catch(function(e){a.$refs.fileImportModal.showImportResult(e.message,!1)})},uploadSuccess:function(){this.handleLoadData({},this.queryParam)},handleExportOrgData:function(){var t=this;this.isExportBtnLoad=!0,Object(s["c"])(this.queryParam).then(function(e){if(e.data.msg)throw new Error(e.msg);Object(o["f"])(e)}).catch(function(e){t.$message.warning(e.message)}).finally(function(){t.isExportBtnLoad=!1})},handleExportTemplate:function(){var t=this;this.isExportTplBtnLoad=!0,Object(s["d"])(this.queryParam).then(function(e){if(e.data.msg)throw new Error(e.msg);Object(o["f"])(e)}).catch(function(e){t.$message.warning(e.message)}).finally(function(){t.isExportTplBtnLoad=!1})}},components:{orgDetailModal:c["default"],modalMenuManage:m["default"],fileImportModal:d["default"],ModalModuleAccredit:l["default"]}},g=p,f=(a("1e7c"),a("2877")),h=Object(f["a"])(g,r,n,!1,null,"69d87604",null);t["default"]=h.exports},9905:function(e,t,a){},d3d2:function(e,t,a){"use strict";a.r(t);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"modalOrgAdd"}},[a("c-resizable-modal",{ref:"crm",attrs:{title:"新增机构",isVisible:t.isModalVisible,modalWidth:"40%"}},[a("a-radio-group",{model:{value:t.isParentOrg,callback:function(e){t.isParentOrg=e},expression:"isParentOrg"}},[a("a-radio",{attrs:{value:"parent"}},[t._v("根机构")]),a("a-radio",{attrs:{value:"children"}},[t._v("子机构")])],1),"children"===t.isParentOrg?a("h4",[t._v(" 上级机构号：****** "),a("a-divider",{attrs:{type:"vertical"}}),t._v(" 上级机构名称：****** ")],1):t._e(),a("a-form-model",{attrs:{model:t.addform,labelCol:{span:4},wrapperCol:{span:16}}},[a("a-form-model-item",{attrs:{label:"机构号"}},[a("a-input",{model:{value:t.addform.orgNum,callback:function(e){t.$set(t.addform,"orgNum",e)},expression:"addform.orgNum"}})],1),a("a-form-model-item",{attrs:{label:"机构名称"}},[a("a-input",{model:{value:t.addform.orgName,callback:function(e){t.$set(t.addform,"orgName",e)},expression:"addform.orgName"}})],1),a("a-form-model-item",{attrs:{label:"机构别名"}},[a("a-input",{model:{value:t.addform.orgAlias,callback:function(e){t.$set(t.addform,"orgAlias",e)},expression:"addform.orgAlias"}})],1),a("a-form-model-item",{attrs:{label:"状态"}},[a("a-radio-group",{model:{value:t.addform.status,callback:function(e){t.$set(t.addform,"status",e)},expression:"addform.status"}},[a("a-radio",{attrs:{value:"parent"}},[t._v("启用")]),a("a-radio",{attrs:{value:"children"}},[t._v("禁用")])],1)],1),a("a-form-model-item",{attrs:{label:"顺序"}},[a("a-input",{model:{value:t.addform.sx,callback:function(e){t.$set(t.addform,"sx",e)},expression:"addform.sx"}})],1),a("a-form-model-item",{attrs:{label:"开始日期"}},[a("a-date-picker",{staticStyle:{width:"100%"},model:{value:t.addform.startDate,callback:function(e){t.$set(t.addform,"startDate",e)},expression:"addform.startDate"}})],1),a("a-form-model-item",{attrs:{label:"结束日期"}},[a("a-date-picker",{staticStyle:{width:"100%"},model:{value:t.addform.endDate,callback:function(e){t.$set(t.addform,"endDate",e)},expression:"addform.endDate"}})],1),a("a-form-model-item",{attrs:{label:"备注"}},[a("a-input",{attrs:{type:"textarea"},model:{value:t.addform.note,callback:function(e){t.$set(t.addform,"note",e)},expression:"addform.note"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("a-button",{staticClass:"margin-btn",attrs:{type:"info",icon:"close"},on:{click:t.handleCancel}},[t._v("取 消")]),a("a-button",{staticClass:"margin-btn",attrs:{type:"primary",icon:"check",loading:t.saveLoading},on:{click:t.handleSave}},[t._v("保存")])],1)],1)],1)},n=[],i=(a("d3b7"),a("25f0"),a("ed08"),{data:function(){return{currentStep:0,isModalVisible:!1,saveLoading:!1,leftSourceData:[],rightTargetKeys:[],isParentOrg:"parent",spinning:!0,addform:{orgNum:"",orgName:"",orgAlias:"",status:"",startDate:"",endDate:"",note:"",sx:""}}},methods:{reset:function(){this.leftSourceData=[],this.rightTargetKeys=[]},open:function(){this.spinning=!0,this.$refs.crm.open(),this.getTestData()},close:function(){this.$refs.crm.close()},handleSave:function(){var e=this;this.saveLoading=!0,setTimeout(function(){e.saveLoading=!1,e.$refs.crm.close()},2e3),this.$message.success("触发保存事件")},getTestData:function(){var t=this;new Promise(function(e,t){for(var a=[],r=0;r<20;r++){var n={key:r.toString(),title:"测试用户项"+(r+1),disabled:r%3<1};a.push(n)}e(a)}).then(function(e){setTimeout(function(){t.leftSourceData=e,t.spinning=!1},1e3)})},handleCancel:function(){var e=this;this.$confirm({title:"表单存在内容",content:"表单上已有输入的信息，关闭后信息会清空，确认关闭吗？",onOk:function(){e.$message.info("触发关闭事件"),e.$refs.crm.close()},onCancel:function(){}})},filterOption:function(e,t){return t.title.indexOf(e)>-1},handleChange:function(e,t,a){this.rightTargetKeys=e},handleSearch:function(e,t){}},mounted:function(){this.$nextTick(function(){})}}),s=i,o=a("2877"),l=Object(o["a"])(s,r,n,!1,null,null,null);t["default"]=l.exports},f305:function(e,t,a){"use strict";a.r(t);var r=function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("div",[r("c-resizable-modal",{ref:"crm",attrs:{modalWidth:"75%",title:("insert"==a.mode?"新增":"编辑")+"机构"}},[r("a-spin",{attrs:{spinning:a.spin}},[r("a-form-model",{ref:"addForm",attrs:{model:a.addForm,labelCol:{span:6},wrapperCol:{span:18},rules:a.addFormRule}},[r("a-row",{attrs:{gutter:15}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"机构编号",prop:"orgCode"}},[r("a-input",{model:{value:a.addForm.orgCode,callback:function(e){a.$set(a.addForm,"orgCode",e)},expression:"addForm.orgCode"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"机构名称",prop:"orgName"}},[r("a-input",{model:{value:a.addForm.orgName,callback:function(e){a.$set(a.addForm,"orgName",e)},expression:"addForm.orgName"}})],1)],1)],1),r("a-row",{attrs:{gutter:15}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"机构简称",prop:"aliasName"}},[r("a-input",{model:{value:a.addForm.aliasName,callback:function(e){a.$set(a.addForm,"aliasName",e)},expression:"addForm.aliasName"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"机构级别",prop:"orgLevel"}},[r("a-select",{staticStyle:{width:"100%"},model:{value:a.addForm.orgLevel,callback:function(e){a.$set(a.addForm,"orgLevel",e)},expression:"addForm.orgLevel"}},[r("a-select-option",{attrs:{value:"1"}},[a._v(" 总行 ")]),r("a-select-option",{attrs:{value:"2"}},[a._v(" 分行 ")]),r("a-select-option",{attrs:{value:"3"}},[a._v(" 支行 ")]),r("a-select-option",{attrs:{value:"4"}},[a._v(" 网点 ")])],1)],1)],1)],1),r("a-row",{attrs:{gutter:15}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"机构类型",prop:"orgType"}},[r("a-select",{staticStyle:{width:"100%"},model:{value:a.addForm.orgType,callback:function(e){a.$set(a.addForm,"orgType",e)},expression:"addForm.orgType"}},[r("a-select-option",{attrs:{value:"1"}},[a._v(" 机构 ")]),r("a-select-option",{attrs:{value:"2"}},[a._v(" 部门 ")])],1)],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"排序",prop:"sort"}},[r("a-input-number",{staticStyle:{width:"100%"},model:{value:a.addForm.sort,callback:function(e){a.$set(a.addForm,"sort",e)},expression:"addForm.sort"}})],1)],1)],1),r("a-row",{attrs:{gutter:15}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"负责人",prop:"leaderSid"}},[r("a-select",{attrs:{"show-search":"",filterOption:a.filterOption,placeholder:"输入检索或下拉以选择用户"},model:{value:a.addForm.leaderSid,callback:function(e){a.$set(a.addForm,"leaderSid",e)},expression:"addForm.leaderSid"}},a._l(a.leaderList,function(e,t){return r("a-select-option",{key:t,attrs:{value:e.userCode}},[a._v(" "+a._s(e.userName)+"（"+a._s(e.userCode)+"） ")])}),1)],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"上级机构/部门编号",prop:"parentSid"}},[r("a-tree-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","tree-node-filter-prop":"title","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"下拉选择上级编号","allow-clear":"","tree-data":a.treeData},model:{value:a.addForm.parentSid,callback:function(e){a.$set(a.addForm,"parentSid",e)},expression:"addForm.parentSid"}})],1)],1)],1),r("a-row",{attrs:{gutter:15}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"机构状态",prop:"status"}},[r("a-radio-group",{attrs:{name:"radioGroup"},model:{value:a.addForm.status,callback:function(e){a.$set(a.addForm,"status",e)},expression:"addForm.status"}},[r("a-radio",{attrs:{value:"0"}},[a._v(" 正常 ")]),r("a-radio",{attrs:{value:"1"}},[a._v(" 停用 ")])],1)],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"删除标志",prop:"delFlag"}},[r("a-radio-group",{attrs:{name:"radioGroup",disabled:""},model:{value:a.addForm.delFlag,callback:function(e){a.$set(a.addForm,"delFlag",e)},expression:"addForm.delFlag"}},[r("a-radio",{attrs:{value:"0"}},[a._v(" 存在 ")]),r("a-radio",{attrs:{value:"1"}},[a._v(" 删除 ")])],1)],1)],1)],1),r("a-row",{attrs:{gutter:15}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"生效日期",prop:"beginDate"}},[r("a-date-picker",{staticStyle:{width:"100%"},attrs:{valueFormat:"YYYY-MM-DD"},model:{value:a.addForm.beginDate,callback:function(e){a.$set(a.addForm,"beginDate",e)},expression:"addForm.beginDate"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"失效日期",prop:"endDate"}},[r("a-date-picker",{staticStyle:{width:"100%"},attrs:{valueFormat:"YYYY-MM-DD"},model:{value:a.addForm.endDate,callback:function(e){a.$set(a.addForm,"endDate",e)},expression:"addForm.endDate"}})],1)],1)],1),r("a-row",{attrs:{gutter:15}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"创建者编号",prop:"creatorSid"}},[r("a-input",{attrs:{disabled:""},model:{value:a.addForm.creatorSid,callback:function(e){a.$set(a.addForm,"creatorSid",e)},expression:"addForm.creatorSid"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"创建时间",prop:"createTime"}},[r("a-date-picker",{staticStyle:{width:"100%"},attrs:{showTime:{format:"HH:mm:ss"},disabled:""},model:{value:a.addForm.createTime,callback:function(e){a.$set(a.addForm,"createTime",e)},expression:"addForm.createTime"}})],1)],1)],1),r("a-row",{attrs:{gutter:15}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"修改者编号",prop:"editorSid"}},[r("a-input",{attrs:{disabled:""},model:{value:a.addForm.editorSid,callback:function(e){a.$set(a.addForm,"editorSid",e)},expression:"addForm.editorSid"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"修改时间",prop:"updateTime"}},[r("a-date-picker",{staticStyle:{width:"100%"},attrs:{showTime:{format:"HH:mm:ss"},disabled:""},model:{value:a.addForm.updateTime,callback:function(e){a.$set(a.addForm,"updateTime",e)},expression:"addForm.updateTime"}})],1)],1)],1),r("a-row",{attrs:{gutter:6}},[r("a-col",{attrs:{span:24}},[r("a-form-model-item",{attrs:{label:"备注",prop:"note",labelCol:{span:3},wrapperCol:{span:21}}},[r("a-input",{attrs:{type:"textarea"},model:{value:a.addForm.remark,callback:function(e){a.$set(a.addForm,"remark",e)},expression:"addForm.remark"}})],1)],1)],1)],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("a-button",{staticClass:"margin-btn",attrs:{type:"info",icon:"close"},on:{click:a.handleCancel}},[a._v("取 消")]),r("a-button",{staticClass:"margin-btn",attrs:{type:"primary",icon:"check",loading:a.saveLoading},on:{click:a.handleSave}},[a._v("保存")])],1)],1)],1)},n=[],i=(a("d3b7"),a("7bec")),s=a("f5ef"),o=a("7e6c"),l=a("c0c7"),d=a("ed08"),c=i["a"].SHOW_PARENT,m={data:function(){return{mode:"read",spin:!1,SHOW_PARENT:c,isModalVisible:!1,saveLoading:!1,treeData:[],addForm:{orgCode:"",orgName:"",aliasName:"",orgLevel:"",orgType:"",sort:"",parentSid:"",status:"0",delFlag:"0",beginDate:"",endDate:"9999-12-31",creatorSid:"",createTime:"",editorSid:"",updateTime:"",remark:""},addFormRule:{orgCode:[{required:!0,message:"机构编号不允许为空",trigger:"blur"}],orgName:[{required:!0,message:"机构名称不允许为空",trigger:"blur"}],orgLevel:[{required:!0,message:"必须选择一个机构级别",trigger:"blur"}],orgType:[{required:!0,message:"必须选择一个机构类型",trigger:"blur"}],status:[{required:!0,message:"必须给定一个状态",trigger:"blur"}],beginDate:[{required:!0,message:"必须填写日期",trigger:"blur"}],endDate:[{required:!0,message:"必须填写日期",trigger:"blur"}]},leaderList:[]}},methods:{loadTreeData:function(){var t=this;Object(o["i"])("all",null).then(function(e){t.treeData=Object(d["c"])(e.data)})},getDefaultValue:function(){return{orgCode:"",orgName:"",aliasName:"",orgLevel:"",orgType:"",sort:"",parentSid:"",status:"0",delFlag:"0",beginDate:"",endDate:"9999-12-31",creatorSid:"",createTime:"",editorSid:"",updateTime:"",remark:""}},open:function(e){this.loadTreeData(),this.addForm=this.getDefaultValue(),this.getUserList(),this.mode=e.mode,this.$refs.crm.open(),this.addForm.parentSid=e.sid,"edit"==this.mode&&(this.spin=!0,this.getDataBySid(e.sid)),this.isModalVisible=!0},getDataBySid:function(e){var t=this;Object(o["h"])(e).then(function(e){t.addForm=e.data}).finally(function(){t.spin=!1})},getUserList:function(){var t=this;Object(l["f"])(null,null,null).then(function(e){t.leaderList=e.rows})},handleSave:function(){var t=this;this.$refs.addForm.validate(function(e){e&&(t.saveLoading=!0,"insert"==t.mode?t.createOrg():t.editOrg())})},editOrg:function(){var t=this;Object(o["n"])(this.addForm).then(function(e){if(!Object(d["l"])(e))throw new Error(e.msg);t.$message.success("数据已更新")}).catch(function(e){t.$message.error("请求异常："+e.message)}).finally(function(){t.saveLoading=!1,s["a"].$emit("reloadData"),t.$refs.crm.close()})},createOrg:function(){var t=this;Object(o["a"])(this.addForm).then(function(e){if(!Object(d["l"])(e))throw new Error(e.msg);t.$message.success("数据已新增"),s["a"].$emit("reloadData"),t.$refs.crm.close()}).catch(function(e){t.$message.error("请求异常："+e.message)}).finally(function(){t.saveLoading=!1})},handleCancel:function(){var e=this;e.$refs.crm.close()},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}}},u=m,p=a("2877"),g=Object(p["a"])(u,r,n,!1,null,null,null);t["default"]=g.exports}}]);