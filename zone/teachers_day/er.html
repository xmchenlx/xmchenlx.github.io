<!DOCTYPE html>
<html lang="zh-cn">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>教资科二·二十连抽</title>
		<style>
			#option {
				min-width: 200px;
				display: inline-block;
			}
			.redText,
			#rightAnswer {
				color: red;
				border-bottom: 1px solid black;
			}
			.rightAnswer {
				font-size: 0.6rem;
				display: none;
				color: red;
			}
			#loadDataDate {
				color: white;
				background-color: rgb(48, 66, 168);
				border-radius: 4px;
				width: 400px;
			}
		</style>
	</head>
	<p>
		*解释：本页面内容来自小程序专题预览的同学测试题库。没有提交内容，仅供预览。题随机抽取，刷新页面题目会立即更新。
	</p>
	<p id="loadDataDate"></p>
	<div id="quest"></div>
	<body>
		<script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.min.js"></script>
		<script>
			var qalistJson = []

			function generateQAForm(rndCount, maxNumber) {
				let qaListIndex = []
				let fori = 0
				let forj = 0
				if (rndCount > maxNumber) {
					rndCount = maxNumber
				}
				while (fori < rndCount) {
					let currentRndIndex = Math.floor(Math.random() * maxNumber)
					let flagRepeat = false
					for (let forj = 0; forj < qaListIndex.length; forj++) {
						if (qaListIndex[forj] == currentRndIndex) {
							flagRepeat = true
							break
						}
					}
					if (!flagRepeat) {
						qaListIndex.push(currentRndIndex)
						fori++
					}
				}
				console.log(qaListIndex)
				return qaListIndex
			}

			function writeQAForm(qaListIndex, isShowRightOpstion) {
				console.log(qaListIndex)
				for (let i in qaListIndex) {
					let currentQuestion = qalistJson[qaListIndex[i]]
					document.getElementById('quest').innerHTML += `
						                 <h3>[${i}]、<span style="color:gray;padding-right:4px;">[${
						currentQuestion.type
					}]</span>
						                             <span id="q${currentQuestion['#']}">
						                                 ${currentQuestion.question.replaceAll(
																'$',
																'__________'
															)}
						                                 </span></h3>
						                 <button onclick="showAns(${
												currentQuestion['#']
											})">查看答案</button>
			`
				}
			}
			function showAns(i) {
				let currentQuestion = qalistJson[i - 1]
				let fullStr = `
						                                 ${currentQuestion.question}
						                                 `
				let answerArray = currentQuestion.ro
				for (let a in answerArray) {
					fullStr = fullStr.replace(
						'$',
						`<span id='rightAnswer'>${answerArray[a]}</span>`
					)
				}
				console.log(i, fullStr)
				$(`#q${i}`).html(fullStr)
			}
			// getData()
			new Promise((resolve, reject) => {
				$.ajax({
					url: './jz.json',
					type: 'GET',
					dataType: 'json',
					success: (res) => {
						$('#loadDataDate').text(
							`已成功加载维护日期为${res.date}的数据。`
						)
						resolve(res.data)
					},
					error: (err) => {
						$('#loadDataDate').text(`加载数据失败。原因：${err}`)
						reject([])
					},
				})
			}).then((res) => {
				qalistJson = res
				console.log('qalistJson', qalistJson)
				var qalist = generateQAForm(10, qalistJson.length)
				writeQAForm(qalist, false)
			})
		</script>
	</body>
</html>
